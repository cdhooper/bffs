%!PS-Adobe-3.0
%%Creator: groff version 1.08
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Symbol
%%DocumentSuppliedResources: procset grops 1.08 0
%%Pages: 21
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.08 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll 
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Symbol
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72 def/PL
792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron/scaron/zcaron
/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/space
/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright/parenleft
/parenright/asterisk/plus/comma/hyphen/period/slash/zero/one/two/three/four
/five/six/seven/eight/nine/colon/semicolon/less/equal/greater/question/at/A/B/C
/D/E/F/G/H/I/J/K/L/M/N/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash
/bracketright/circumflex/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q
/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase
/guillemotleft/guillemotright/bullet/florin/fraction/perthousand/dagger
/daggerdbl/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guilsinglleft/logicalnot/minus
/registered/macron/degree/plusminus/twosuperior/threesuperior/acute/mu
/paragraph/periodcentered/cedilla/onesuperior/ordmasculine/guilsinglright
/onequarter/onehalf/threequarters/questiondown/Agrave/Aacute/Acircumflex/Atilde
/Adieresis/Aring/AE/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute
/Icircumflex/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn/germandbls
/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla/egrave/eacute
/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis/eth/ntilde/ograve
/oacute/ocircumflex/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex
/udieresis/yacute/thorn/ydieresis]def/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(Fsck \255 The UNIX\207 File System Check Pr)166.536 123
Q(ogram)-.216 E/F1 10/Times-Italic@0 SF(Mar)238.63 147 Q(shall Kirk McK)-.1 E
(usic)-.4 E(k)-.2 E/F2 10/Times-Roman@0 SF(Computer Systems Research Group)
216.48 165 Q(Computer Science Di)232.85 177 Q(vision)-.25 E
(Department of Electrical Engineering and Computer Science)166.36 189 Q(Uni)
219.725 201 Q -.15(ve)-.25 G(rsity of California, Berk).15 E(ele)-.1 E(y)-.15 E
(Berk)245.955 213 Q(ele)-.1 E 1.3 -.65(y, C)-.15 H 5(A9).65 G(4720)310.045 213
Q F1 1.48 -.74(T. J)260.08 237 T 2.5(.K).49 G(owalski)285.36 237 Q F2
(Bell Laboratories)253.145 255 Q(Murray Hill, Ne)224.74 267 Q 2.5(wJ)-.25 G
(erse)302.81 267 Q 2.5(y0)-.15 G(7974)331.26 267 Q F1(ABSTRA)264.535 303 Q(CT)
-.3 E F2 1.406(This document re\215ects the use of)133 330.6 R F1(fsc)3.905 E
(k)-.2 E F2 1.405(with the 4.2BSD and 4.3BSD \214le system)3.905 F(or)108 342.6
Q -.05(ga)-.18 G 2.5(nization. This).05 F(is a re)2.5 E
(vision of the original paper written by T)-.25 E 2.5(.J)-.74 G 2.5(.K)377.58
342.6 S -2.1 -.25(ow a)389.45 342.6 T(lski.).25 E 1.535
(File System Check Program \()133 358.2 R F1(fsc)A(k)-.2 E F2 4.036(\)i)C 4.036
(sa)282.968 358.2 S 4.036(ni)295.334 358.2 S(nteracti)307.15 358.2 Q 1.836 -.15
(ve \214)-.25 H 1.536(le system check and repair).15 F(program.)108 370.2 Q F1
(Fsc)5.484 E(k)-.2 E F2 .484
(uses the redundant structural information in the UNIX \214le system to per)
2.984 F(-)-.2 E 1.768(form se)108 382.2 R -.15(ve)-.25 G 1.768(ral consistenc)
.15 F 4.268(yc)-.15 G 4.268(hecks. If)219.114 382.2 R 1.768(an inconsistenc)
4.268 F 4.268(yi)-.15 G 4.269(sd)337.126 382.2 S 1.769
(etected, it is reported to the)350.285 382.2 R(operator)108 394.2 Q 2.953(,w)
-.4 G .453(ho may elect to \214x or ignore each inconsistenc)153.593 394.2 R
4.252 -.65(y. T)-.15 H .452(hese inconsistencies result).65 F 1.22(from the pe\
rmanent interruption of the \214le system updates, which are performed e)108
406.2 R -.15(ve)-.25 G(ry).15 E .008(time a \214le is modi\214ed.)108 418.2 R
.008(Unless there has been a hardw)5.008 F .008(are f)-.1 F(ailure,)-.1 E F1
(fsc)2.507 E(k)-.2 E F2 .007(is able to repair cor)2.507 F(-)-.2 E .838(rupted\
 \214le systems using procedures based upon the order in which UNIX honors the\
se)108 430.2 R(\214le system update requests.)108 442.2 Q .26(The purpose of t\
his document is to describe the normal updating of the \214le system,)133 457.8
R 1.829(to discuss the possible causes of \214le system corruption, and to pre\
sent the correcti)108 469.8 R -.15(ve)-.25 G .392(actions implemented by)108
481.8 R F1(fsc)2.892 E(k.)-.2 E F2 .392
(Both the program and the interaction between the program)5.392 F
(and the operator are described.)108 493.8 Q(Re)108 533.4 Q
(vised July 16, 1985)-.25 E .32 LW 144 676.4 72 676.4 DL/F3 8/Times-Roman@0 SF
(\207UNIX is a trademark of Bell Laboratories.)72 688.2 Q .941(This w)72 700 R
.941(ork w)-.08 F .94(as done under grants from the National Science F)-.08 F
.94(oundation under grant MCS80-05144, and the)-.12 F .262(Defense Adv)72 710 R
.262(ance Research Projects Agenc)-.2 F 2.262(y\()-.12 G .262
(DoD\) under Arpa Order No. 4031 monitored by Na)220.27 710 R -.2(va)-.16 G
2.263(lE).2 G(lectronic)404.008 710 Q
(System Command under Contract No. N00039-82-C-0235.)72 720 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 237.008(SMM:3-2 The)72 48 R/F1 8/Times-Roman@0 SF(UNIX)
2.5 E F0(File System Check Program)2.5 E/F2 10/Times-Bold@0 SF -.9(TA)234.55 84
S(BLE OF CONTENTS).9 E 2.5(1. Intr)72 111.6 R(oduction)-.18 E 2.5(2. Ov)72
133.2 R(er)-.1 E(view of the \214le system)-.1 E F0 7.5(2.1. Superblock)72
145.2 R 7.5(2.2. Summary)72 157.2 R(Information)2.5 E 7.5(2.3. Cylinder)72
169.2 R(groups)2.5 E 7.5(2.4. Fragments)72 181.2 R 7.5(2.5. Updates)72 193.2 R
(to the \214le system)2.5 E F2 2.5(3. Fixing)72 214.8 R
(corrupted \214le systems)2.5 E F0 7.5(3.1. Detecting)72 226.8 R
(and correcting corruption)2.5 E 7.5(3.2. Super)72 238.8 R(block checking)2.5 E
7.5(3.3. Free)72 250.8 R(block checking)2.5 E 7.5(3.4. Checking)72 262.8 R
(the inode state)2.5 E 7.5(3.5. Inode)72 274.8 R(links)2.5 E 7.5(3.6. Inode)72
286.8 R(data size)2.5 E 7.5(3.7. Checking)72 298.8 R
(the data associated with an inode)2.5 E 7.5(3.8. File)72 310.8 R
(system connecti)2.5 E(vity)-.25 E F2(Ackno)72 332.4 Q(wledgements)-.1 E(Refer)
72 354 Q(ences)-.18 E 2.5(4. A)72 375.6 R(ppendix A)-.25 E F0 10(4.1. Con)72
387.6 R -.15(ve)-.4 G(ntions).15 E 10(4.2. Initialization)72 399.6 R 10
(4.3. Phase)72 411.6 R 2.5(1-C)2.5 G(heck Blocks and Sizes)145.33 411.6 Q 10
(4.4. Phase)72 423.6 R(1b - Rescan for more Dups)2.5 E 10(4.5. Phase)72 435.6 R
2.5(2-C)2.5 G(heck P)145.33 435.6 Q(athnames)-.15 E 10(4.6. Phase)72 447.6 R
2.5(3-C)2.5 G(heck Connecti)145.33 447.6 Q(vity)-.25 E 10(4.7. Phase)72 459.6 R
2.5(4-C)2.5 G(heck Reference Counts)145.33 459.6 Q 10(4.8. Phase)72 471.6 R 2.5
(5-C)2.5 G(heck Cyl groups)145.33 471.6 Q 10(4.9. Cleanup)72 483.6 R EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-3)464.55 48 Q/F2 10/Times-Bold@0 SF 2.5
(1. Intr)72 84 R(oduction)-.18 E F0 .222(This document re\215ects the use of)97
99.6 R/F3 10/Times-Italic@0 SF(fsc)2.722 E(k)-.2 E F0 .223
(with the 4.2BSD and 4.3BSD \214le system or)2.722 F -.05(ga)-.18 G 2.723
(nization. This).05 F(is)2.723 E 2.5(ar)72 111.6 S -.25(ev)82.27 111.6 S
(ision of the original paper written by T).25 E 2.5(.J)-.74 G 2.5(.K)254.87
111.6 S -2.1 -.25(ow a)266.74 111.6 T(lski.).25 E .272
(When a UNIX operating system is brought up, a consistenc)97 127.2 R 2.772(yc)
-.15 G .272(heck of the \214le systems should al)349.25 127.2 R -.1(wa)-.1 G
(ys).1 E .016(be performed.)72 139.2 R .017
(This precautionary measure helps to insure a reliable en)5.016 F .017
(vironment for \214le storage on disk.)-.4 F(If)5.017 E .032(an inconsistenc)72
151.2 R 2.532(yi)-.15 G 2.532(sd)143.574 151.2 S(isco)154.996 151.2 Q -.15(ve)
-.15 G .031(red, correcti).15 F .331 -.15(ve a)-.25 H .031(ction must be tak)
.15 F(en.)-.1 E F3(Fsc)5.031 E(k)-.2 E F0 .031(runs in tw)2.531 F 2.531(om)-.1
G 2.531(odes. Normally)406.656 151.2 R .031(it is run)2.531 F(non-interacti)72
163.2 Q -.15(ve)-.25 G .182(ly by the system after a normal boot.).15 F .183
(When running in this mode, it will only mak)5.182 F 2.683(ec)-.1 G(hanges)
476.23 163.2 Q .036(to the \214le system that are kno)72 175.2 R .035(wn to al)
-.25 F -.1(wa)-.1 G .035(ys be correct.).1 F .035(If an une)5.035 F .035
(xpected inconsistenc)-.15 F 2.535(yi)-.15 G 2.535(sf)420.88 175.2 S(ound)
430.635 175.2 Q F3(fsc)2.535 E(k)-.2 E F0 .035(will e)2.535 F(xit)-.15 E 1.004
(with a non-zero e)72 187.2 R 1.004(xit status, lea)-.15 F 1.005
(ving the system running single-user)-.2 F 6.005(.T)-.55 G 1.005
(ypically the operator then runs)358.925 187.2 R F3(fsc)3.505 E(k)-.2 E F0
(interacti)72 199.2 Q -.15(ve)-.25 G(ly).15 E 5.196(.W)-.65 G .195
(hen running in this mode, each problem is listed follo)138.076 199.2 R .195
(wed by a suggested correcti)-.25 F .495 -.15(ve a)-.25 H(ction.).15 E(The ope\
rator must decide whether or not the suggested correction should be made.)72
211.2 Q .745(The purpose of this memo is to dispel the mystique surrounding \
\214le system inconsistencies.)97 226.8 R .745(It \214rst)5.745 F .367(describ\
es the updating of the \214le system \(the calm before the storm\) and then de\
scribes \214le system corrup-)72 238.8 R .045(tion \(the storm\).)72 250.8 R
(Finally)5.045 E 2.545(,t)-.65 G .045(he set of deterministic correcti)177.37
250.8 R .345 -.15(ve a)-.25 H .045(ctions used by).15 F F3(fsc)2.545 E(k)-.2 E
F0 .045(\(the Coast Guard to the res-)2.545 F(cue\) is presented.)72 262.8 Q F2
2.5(2. Ov)72 286.8 R(er)-.1 E(view of the \214le system)-.1 E F0
(The \214le system is discussed in detail in [Mckusick84]; this section gi)97
302.4 Q -.15(ve)-.25 G 2.5(sab).15 G(rief o)400.2 302.4 Q -.15(ve)-.15 G(rvie)
.15 E -.65(w.)-.25 G F2 2.5(2.1. Superblock)72 326.4 R F0 2.684<418c>97 342 S
.184(le system is described by its)112.464 342 R F3(super)2.684 E(-bloc)-.2 E
(k)-.2 E F0 5.184(.T)C .184(he super)288.612 342 R .183(-block is b)-.2 F .183
(uilt when the \214le system is created)-.2 F(\()72 354 Q F3(ne)A(wfs)-.15 E F0
.16(\(8\)\) and ne)B -.15(ve)-.25 G 2.66(rc).15 G 2.66(hanges. The)161.62 354 R
(super)2.66 E .161
(-block contains the basic parameters of the \214le system, such as the)-.2 F
.803(number of data blocks it contains and a count of the maximum number of \
\214les.)72 366 R .803(Because the super)5.803 F(-block)-.2 E .029
(contains critical data,)72 378 R F3(ne)2.529 E(wfs)-.15 E F0 .029
(replicates it to protect ag)2.529 F .029(ainst catastrophic loss.)-.05 F(The)
5.03 E F3 .03(default super bloc)2.53 F(k)-.2 E F0(al)2.53 E -.1(wa)-.1 G(ys).1
E .529(resides at a \214x)72 390 R .529(ed of)-.15 F .529(fset from the be)-.25
F .529(ginning of the \214le system')-.15 F 3.029(sd)-.55 G .529
(isk partition.)334.438 390 R(The)5.529 E F3 -.37(re)3.028 G .528
(dundant super bloc).37 F(ks)-.2 E F0 .845(are not referenced unless a head cr\
ash or other hard disk error causes the def)72 402 R .845(ault super)-.1 F .845
(-block to be unus-)-.2 F 2.5(able. The)72 414 R
(redundant blocks are sprinkled throughout the disk partition.)2.5 E -.4(Wi)97
429.6 S .611(thin the \214le system are \214les.).4 F .611
(Certain \214les are distinguished as directories and contain collections)5.611
F .514(of pointers to \214les that may themselv)72 441.6 R .515
(es be directories.)-.15 F(Ev)5.515 E .515
(ery \214le has a descriptor associated with it called)-.15 F(an)72 453.6 Q F3
(inode)3.08 E F0 5.58(.T)C .579(he inode contains information describing o)
120.93 453.6 R .579(wnership of the \214le, time stamps indicating modi\214-)
-.25 F .601(cation and access times for the \214le, and an array of indices po\
inting to the data blocks for the \214le.)72 465.6 R .601(In this)5.601 F .707
(section, we assume that the \214rst 12 blocks of the \214le are directly refe\
renced by v)72 477.6 R .707(alues stored in the inode)-.25 F .347
(structure itself\207.)72 489.6 R .348(The inode structure may also contain re\
ferences to indirect blocks containing further data)5.347 F .901
(block indices.)72 501.6 R .901(In a \214le system with a 4096 byte block size\
, a singly indirect block contains 1024 further)5.901 F 1.157(block addresses,\
 a doubly indirect block contains 1024 addresses of further single indirect bl\
ocks, and a)72 513.6 R .822(triply indirect block contains 1024 addresses of f\
urther doubly indirect blocks \(the triple indirect block is)72 525.6 R(ne)72
537.6 Q -.15(ve)-.25 G 2.5(rn).15 G(eeded in practice\).)101.31 537.6 Q .33
(In order to create \214les with up to 2)97 553.2 R/F4 10/Symbol SF<ad>A F0 .33
(32 bytes, using only tw)B 2.83(ol)-.1 G -2.15 -.25(ev e)348.87 553.2 T .33
(ls of indirection, the minimum size).25 F .168
(of a \214le system block is 4096 bytes.)72 565.2 R .167
(The size of \214le system blocks can be an)5.167 F 2.667(yp)-.15 G -.25(ow)
394.385 565.2 S .167(er of tw).25 F 2.667(og)-.1 G .167(reater than or)450.356
565.2 R .708(equal to 4096.)72 577.2 R .708
(The block size of the \214le system is maintained in the super)5.708 F .709
(-block, so it is possible for \214le)-.2 F .595(systems of dif)72 589.2 R .595
(ferent block sizes to be accessible simultaneously on the same system.)-.25 F
.595(The block size must)5.595 F 1.61(be decided when)72 601.2 R F3(ne)4.11 E
(wfs)-.15 E F0 1.611(creates the \214le system; the block size cannot be subse\
quently changed without)4.11 F(reb)72 613.2 Q(uilding the \214le system.)-.2 E
F2 2.5(2.2. Summary)72 637.2 R(inf)2.5 E(ormation)-.25 E F0 .772
(Associated with the super block is non replicated)97 652.8 R F3 .771
(summary information)3.272 F F0 5.771(.T)C .771(he summary information)403.578
652.8 R 1.432(changes as the \214le system is modi\214ed.)72 664.8 R 1.433
(The summary information contains the number of blocks, frag-)6.433 F
(ments, inodes and directories in the \214le system.)72 676.8 Q .32 LW 144
708.2 72 708.2 DL F1(\207The actual number may v)72 720 Q
(ary from system to system, b)-.2 E(ut is usually in the range 5-13.)-.16 E EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 237.008(SMM:3-4 The)72 48 R/F1 8/Times-Roman@0 SF(UNIX)
2.5 E F0(File System Check Program)2.5 E/F2 10/Times-Bold@0 SF 2.5
(2.3. Cylinder)72 84 R(gr)2.5 E(oups)-.18 E F0 .205
(The \214le system partitions the disk into one or more areas called)97 99.6 R
/F3 10/Times-Italic@0 SF .204(cylinder gr)2.705 F(oups)-.45 E F0 5.204(.A)C
-.15(cy)435.972 99.6 S .204(linder group is).15 F 1.11
(comprised of one or more consecuti)72 111.6 R 1.41 -.15(ve cy)-.25 H 1.111
(linders on a disk.).15 F 1.111(Each c)6.111 F 1.111
(ylinder group includes inode slots for)-.15 F .879(\214les, a)72 123.6 R F3
(bloc)3.379 E 3.379(km)-.2 G(ap)134.427 123.6 Q F0 .879(describing a)3.379 F
-.25(va)-.2 G .879(ilable blocks in the c).25 F .878
(ylinder group, and summary information describing)-.15 F .264
(the usage of data blocks within the c)72 135.6 R .264(ylinder group.)-.15 F
2.764<418c>5.264 G -.15(xe)297.238 135.6 S 2.764(dn).15 G .264
(umber of inodes is allocated for each c)319.292 135.6 R(ylinder)-.15 E .834
(group when the \214le system is created.)72 147.6 R .834(The current polic)
5.834 F 3.334(yi)-.15 G 3.334(st)315.15 147.6 S 3.334(oa)325.154 147.6 S .833
(llocate one inode for each 2048 bytes of)337.928 147.6 R
(disk space; this is e)72 159.6 Q(xpected to be f)-.15 E
(ar more inodes than will e)-.1 E -.15(ve)-.25 G 2.5(rb).15 G 2.5(en)332.14
159.6 S(eeded.)344.08 159.6 Q 1.139(All the c)97 175.2 R 1.139
(ylinder group bookk)-.15 F 1.139(eeping information could be placed at the be)
-.1 F 1.14(ginning of each c)-.15 F(ylinder)-.15 E 3.189(group. Ho)72 187.2 R
(we)-.25 E -.15(ve)-.25 G 3.189(ri).15 G 3.189(ft)145.488 187.2 S .689
(his approach were used, all the redundant information w)154.787 187.2 R .689
(ould be on the top platter)-.1 F 5.688(.A)-.55 G 1.267(single hardw)72 199.2 R
1.267(are f)-.1 F 1.267(ailure that destro)-.1 F 1.268
(yed the top platter could cause the loss of all copies of the redundant)-.1 F
(super)72 211.2 Q 2.957(-blocks. Thus)-.2 F .457(the c)2.957 F .457
(ylinder group bookk)-.15 F .457(eeping information be)-.1 F .456
(gins at a \215oating of)-.15 F .456(fset from the be)-.25 F(gin-)-.15 E 1.468
(ning of the c)72 223.2 R 1.468(ylinder group.)-.15 F 1.468(The of)6.468 F
1.468(fset for the)-.25 F F3(i+1)3.968 E F0 1.468(st c)B 1.469
(ylinder group is about one track further from the)-.15 F(be)72 235.2 Q .48
(ginning of the c)-.15 F .48(ylinder group than it w)-.15 F .48(as for the)-.1
F F3(i)2.98 E F0 .48(th c)B .48(ylinder group.)-.15 F .48(In this w)5.48 F(ay)
-.1 E 2.98(,t)-.65 G .48(he redundant informa-)413.62 235.2 R .288
(tion spirals do)72 247.2 R .289(wn into the pack; an)-.25 F 2.789(ys)-.15 G
.289(ingle track, c)222.782 247.2 R(ylinder)-.15 E 2.789(,o)-.4 G 2.789(rp)
313.359 247.2 S .289(latter can be lost without losing all copies of)324.478
247.2 R .119(the super)72 259.2 R 2.619(-blocks. Except)-.2 F .119
(for the \214rst c)2.619 F .119(ylinder group, the space between the be)-.15 F
.118(ginning of the c)-.15 F .118(ylinder group)-.15 F(and the be)72 271.2 Q
(ginning of the c)-.15 E(ylinder group information stores data.)-.15 E F2 2.5
(2.4. Fragments)72 295.2 R F0 1.81 -.8(To a)97 310.8 T -.2(vo).6 G .21(id w).2
F .21(aste in storing small \214les, the \214le system space allocator di)-.1 F
.21(vides a single \214le system block)-.25 F .653(into one or more)72 322.8 R
F3(fr)3.153 E -.1(ag)-.15 G(ments).1 E F0 5.652(.T)C .652(he fragmentation of \
the \214le system is speci\214ed when the \214le system is cre-)197.504 322.8 R
1.4(ated; each \214le system block can be optionally brok)72 334.8 R 1.401
(en into 2, 4, or 8 addressable fragments.)-.1 F 1.401(The lo)6.401 F(wer)-.25
E .341(bound on the size of these fragments is constrained by the disk sector \
size; typically 512 bytes is the lo)72 346.8 R(wer)-.25 E .42
(bound on fragment size.)72 358.8 R .42(The block map associated with each c)
5.42 F .42(ylinder group records the space a)-.15 F -.25(va)-.2 G(ilability).25
E(at the fragment le)72 370.8 Q -.15(ve)-.25 G 2.5(l. Aligned).15 F
(fragments are e)2.5 E(xamined to determine block a)-.15 E -.25(va)-.2 G
(ilability).25 E(.)-.65 E .839(On a \214le system with a block size of 4096 by\
tes and a fragment size of 1024 bytes, a \214le is repre-)97 386.4 R .606(sent\
ed by zero or more 4096 byte blocks of data, and possibly a single fragmented \
block.)72 398.4 R .606(If a \214le system)5.606 F .723(block must be fragmente\
d to obtain space for a small amount of data, the remainder of the block is ma\
de)72 410.4 R -.2(av)72 422.4 S .328(ailable for allocation to other \214les.)
-.05 F -.15(Fo)5.328 G 2.828(re).15 G .328
(xample, consider an 11000 byte \214le stored on a 4096/1024 byte)246.576 422.4
R .052(\214le system.)72 434.4 R .052(This \214le uses tw)5.052 F 2.552(of)-.1
G .052(ull size blocks and a 3072 byte fragment.)198.882 434.4 R .051
(If no fragments with at least 3072)5.051 F .542(bytes are a)72 446.4 R -.25
(va)-.2 G .543(ilable when the \214le is created, a full size block is split y\
ielding the necessary 3072 byte frag-).25 F 1.64
(ment and an unused 1024 byte fragment.)72 458.4 R 1.64
(This remaining fragment can be allocated to another \214le, as)6.64 F(needed.)
72 470.4 Q F2 2.5(2.5. Updates)72 494.4 R(to the \214le system)2.5 E F0(Ev)97
510 Q .555(ery w)-.15 F .555
(orking day hundreds of \214les are created, modi\214ed, and remo)-.1 F -.15
(ve)-.15 G 3.055(d. Ev).15 F .555(ery time a \214le is modi-)-.15 F .806
(\214ed, the operating system performs a series of \214le system updates.)72
522 R .805(These updates, when written on disk,)5.805 F .381
(yield a consistent \214le system.)72 534 R .382(The \214le system stages all \
modi\214cations of critical information; modi\214cation)5.381 F .135
(can either be completed or cleanly back)72 546 R .135(ed out after a crash.)
-.1 F(Kno)5.135 E .135(wing the information that is \214rst written to)-.25 F
.366(the \214le system, deterministic procedures can be de)72 558 R -.15(ve)
-.25 G .367(loped to repair a corrupted \214le system.).15 F 1.967 -.8(To u)
5.367 H(nderstand).8 E(this process, the order that the update requests were b\
eing honored must \214rst be understood.)72 570 Q .076
(When a user program does an operation to change the \214le system, such as a)
97 585.6 R F3(write)2.576 E F0 2.576(,t)C .076(he data to be writ-)430.936
585.6 R 1.782(ten is copied into an internal)72 597.6 R F3(in-cor)4.282 E(e)
-.37 E F0 -.2(bu)4.282 G -.25(ff).2 G 1.782(er in the k).25 F 4.282
(ernel. Normally)-.1 F 4.283(,t)-.65 G 1.783(he disk update is handled asyn-)
369.825 597.6 R .056(chronously; the user process is allo)72 609.6 R .055
(wed to proceed e)-.25 F -.15(ve)-.25 G 2.555(nt).15 G .055
(hough the data has not yet been written to the disk.)299.86 609.6 R .193
(The data, along with the inode information re\215ecting the change, is e)72
621.6 R -.15(ve)-.25 G .194(ntually written out to disk.).15 F .194(The real)
5.194 F .605(disk write may not happen until long after the)72 633.6 R F3
(write)3.104 E F0 .604(system call has returned.)3.104 F .604(Thus at an)5.604
F 3.104(yg)-.15 G -2.15 -.25(iv e)448.472 633.6 T 3.104(nt).25 G .604(ime, the)
471.176 633.6 R .225(\214le system, as it resides on the disk, lags the state \
of the \214le system represented by the in-core information.)72 645.6 R 1.446(\
The disk information is updated to re\215ect the in-core information when the \
b)97 661.2 R(uf)-.2 E 1.446(fer is required for)-.25 F .297
(another use, when a)72 673.2 R F3(sync)2.797 E F0 .297
(\(2\) is done \(at 30 second interv)B .297(als\) by)-.25 F F3(/etc/update)
2.797 E F0 .297(\(8\), or by manual operator inter)B(-)-.2 E -.15(ve)72 685.2 S
.363(ntion with the).15 F F3(sync)2.863 E F0 .363(\(8\) command.)B .362
(If the system is halted without writing out the in-core information, the)5.363
F(\214le system on the disk will be in an inconsistent state.)72 697.2 Q .667
(If all updates are done asynchronously)97 712.8 R 3.167(,s)-.65 G -2.15 -.25
(ev e)263.372 712.8 T .668(ral serious inconsistencies can arise.).25 F .668
(One inconsistenc)5.668 F(y)-.15 E .487(is that a block may be claimed by tw)72
724.8 R 2.987(oi)-.1 G 2.987(nodes. Such)233.213 724.8 R .487(an inconsistenc)
2.987 F 2.987(yc)-.15 G .487(an occur when the system is halted)361.661 724.8 R
EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-5)464.55 48 Q .742
(before the pointer to the block in the old inode has been cleared in the cop)
72 84 R 3.242(yo)-.1 G 3.243(ft)392.602 84 S .743(he old inode on the disk,)
401.955 84 R .273(and after the pointer to the block in the ne)72 96 R 2.773
(wi)-.25 G .273(node has been written out to the cop)254.451 96 R 2.773(yo)-.1
G 2.773(ft)413.735 96 S .273(he ne)422.618 96 R 2.773(wi)-.25 G .273
(node on the)456.794 96 R 3.652(disk. Here,)72 108 R 1.153(there is no determi\
nistic method for deciding which inode should really claim the block.)3.652 F
(A)6.153 E(similar problem can arise with a multiply claimed inode.)72 120 Q
.572(The problem with asynchronous inode updates can be a)97 135.6 R -.2(vo)-.2
G .572(ided by doing all inode deallocations syn-).2 F(chronously)72 147.6 Q
5.071(.C)-.65 G(onsequently)130.031 147.6 Q 2.571(,i)-.65 G .071
(nodes and indirect blocks are written to the disk synchronously \()185.562
147.6 R/F2 10/Times-Italic@0 SF(i.e)A(.)-.15 E F0 .072(the process)2.572 F .207
(blocks until the information is really written to disk\) when the)72 159.6 R
2.707(ya)-.15 G .207(re being deallocated.)334.387 159.6 R .206
(Similarly inodes are)5.207 F -.1(ke)72 171.6 S(pt consistent by synchronously\
 deleting, adding, or changing directory entries.).1 E/F3 10/Times-Bold@0 SF
2.5(3. Fixing)72 195.6 R(corrupted \214le systems)2.5 E F0 2.91<418c>97 211.2 S
.41(le system can become corrupted in se)112.69 211.2 R -.15(ve)-.25 G .411
(ral w).15 F 2.911(ays. The)-.1 F .411(most common of these w)2.911 F .411
(ays are improper)-.1 F(shutdo)72 223.2 Q(wn procedures and hardw)-.25 E(are f)
-.1 E(ailures.)-.1 E 1.224(File systems may become corrupted during an)97 238.8
R F2 1.224(unclean halt)3.724 F F0 6.224(.T)C 1.224
(his happens when proper shutdo)358.266 238.8 R(wn)-.25 E .28
(procedures are not observ)72 250.8 R .28(ed, ph)-.15 F .28(ysically write-pro\
tecting a mounted \214le system, or a mounted \214le system is)-.05 F(tak)72
262.8 Q .088(en of)-.1 F 2.588(f-line. The)-.25 F .088
(most common operator procedural f)2.588 F .088(ailure is for)-.1 F .088
(getting to)-.18 F F2(sync)2.588 E F0 .088(the system before halting)2.588 F
(the CPU.)72 274.8 Q 1.033(File systems may become further corrupted if proper\
 startup procedures are not observ)97 290.4 R 1.033(ed, e.g., not)-.15 F .224(\
checking a \214le system for inconsistencies, and not repairing inconsistencie\
s.)72 302.4 R(Allo)5.224 E .224(wing a corrupted \214le sys-)-.25 F
(tem to be used \(and, thus, to be modi\214ed further\) can be disastrous.)72
314.4 Q(An)97 330 Q 2.974(yp)-.15 G .474(iece of hardw)122.044 330 R .474
(are can f)-.1 F .475(ail at an)-.1 F 2.975(yt)-.15 G 2.975(ime. F)255.795 330
R .475(ailures can be as subtle as a bad block on a disk pack,)-.15 F
(or as blatant as a non-functional disk-controller)72 342 Q(.)-.55 E F3 2.5
(3.1. Detecting)72 366 R(and corr)2.5 E(ecting corruption)-.18 E F0(Normally)97
381.6 Q F2(fsc)3.167 E(k)-.2 E F0 .667(is run non-interacti)3.167 F -.15(ve)
-.25 G(ly).15 E 5.666(.I)-.65 G 3.166(nt)262.114 381.6 S .666
(his mode it will only \214x corruptions that are e)273.06 381.6 R .666
(xpected to)-.15 F .73(occur from an unclean halt.)72 393.6 R .73
(These actions are a proper subset of the actions that)5.73 F F2(fsc)3.231 E(k)
-.2 E F0 .731(will tak)3.231 F 3.231(ew)-.1 G .731(hen it is)470.868 393.6 R
.216(running interacti)72 405.6 R -.15(ve)-.25 G(ly).15 E 5.216(.T)-.65 G .216
(hroughout this paper we assume that)168.592 405.6 R F2(fsc)2.716 E(k)-.2 E F0
.216(is being run interacti)2.716 F -.15(ve)-.25 G(ly).15 E 2.716(,a)-.65 G
.216(nd all possible)445.788 405.6 R .007(errors can be encountered.)72 417.6 R
.007(When an inconsistenc)5.007 F 2.507(yi)-.15 G 2.507(sd)280.449 417.6 S
(isco)291.846 417.6 Q -.15(ve)-.15 G .007(red in this mode,).15 F F2(fsc)2.508
E(k)-.2 E F0 .008(reports the inconsistenc)2.508 F(y)-.15 E
(for the operator to chose a correcti)72 429.6 Q .3 -.15(ve a)-.25 H(ction.).15
E 2.518(Aq)97 445.2 S .018(uiescent\210 \214le system may be check)111.738
445.2 R .018(ed for structural inte)-.1 F .018(grity by performing consistenc)
-.15 F 2.517(yc)-.15 G .017(hecks on)468.713 445.2 R .138
(the redundant data intrinsic to a \214le system.)72 457.2 R .138
(The redundant data is either read from the \214le system, or com-)5.138 F .273
(puted from other kno)72 469.2 R .273(wn v)-.25 F 2.773(alues. The)-.25 F .273
(\214le system)2.773 F F3(must)2.773 E F0 .273(be in a quiescent state when)
2.773 F F2(fsc)2.773 E(k)-.2 E F0 .273(is run, since)2.773 F F2(fsc)2.773 E(k)
-.2 E F0(is)2.773 E 2.5(am)72 481.2 S(ulti-pass program.)86.72 481.2 Q 1.661
(In the follo)97 496.8 R 1.662(wing sections, we discuss methods to disco)-.25
F -.15(ve)-.15 G 4.162(ri).15 G 1.662(nconsistencies and possible correcti)
346.944 496.8 R -.15(ve)-.25 G .504(actions for the c)72 508.8 R .503(ylinder \
group blocks, the inodes, the indirect blocks, and the data blocks containing \
direc-)-.15 F(tory entries.)72 520.8 Q F3 2.5(3.2. Super)72 544.8 R
(-block checking)-.37 E F0 .561(The most commonly corrupted item in a \214le s\
ystem is the summary information associated with the)97 560.4 R(super)72 572.4
Q 3.066(-block. The)-.2 F .566
(summary information is prone to corruption because it is modi\214ed with e)
3.066 F -.15(ve)-.25 G .566(ry change to).15 F(the \214le system')72 584.4 Q
2.5(sb)-.55 G(locks or inodes, and is usually corrupted after an unclean halt.)
143.95 584.4 Q 1.405(The super)97 600 R 1.405(-block is check)-.2 F 1.405
(ed for inconsistencies in)-.1 F -.2(vo)-.4 G 1.405
(lving \214le-system size, number of inodes, free-).2 F .46
(block count, and the free-inode count.)72 612 R .459
(The \214le-system size must be lar)5.46 F .459
(ger than the number of blocks used)-.18 F 1.081(by the super)72 624 R 1.082
(-block and the number of blocks used by the list of inodes.)-.2 F 1.082
(The \214le-system size and layout)6.082 F 1.039
(information are the most critical pieces of information for)72 636 R F2(fsc)
3.539 E(k)-.2 E F0 6.039(.W)C 1.039(hile there is no w)348.25 636 R 1.038
(ay to actually check)-.1 F .365(these sizes, since the)72 648 R 2.865(ya)-.15
G .365(re statically determined by)168.01 648 R F2(ne)2.865 E(wfs)-.15 E F0(,)A
F2(fsc)2.865 E(k)-.2 E F0 .366(can check that these sizes are within reason-)
2.865 F .772(able bounds.)72 660 R .772
(All other \214le system checks require that these sizes be correct.)5.772 F
(If)5.772 E F2(fsc)3.271 E(k)-.2 E F0 .771(detects corruption in)3.271 F .067
(the static parameters of the def)72 672 R .067(ault super)-.1 F(-block,)-.2 E
F2(fsc)2.567 E(k)-.2 E F0 .067
(requests the operator to specify the location of an alter)2.567 F(-)-.2 E
(nate super)72 684 Q(-block.)-.2 E .32 LW 144 708.2 72 708.2 DL F1 2<8849>72
720 S(.e., unmounted and not being written on.)80.664 720 Q EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 237.008(SMM:3-6 The)72 48 R/F1 8/Times-Roman@0 SF(UNIX)
2.5 E F0(File System Check Program)2.5 E/F2 10/Times-Bold@0 SF 2.5(3.3. Fr)72
84 R(ee block checking)-.18 E/F3 10/Times-Italic@0 SF(Fsc)97 99.6 Q(k)-.2 E F0
.728(checks that all the blocks mark)3.228 F .727(ed as free in the c)-.1 F
.727(ylinder group block maps are not claimed by)-.15 F(an)72 111.6 Q 2.816
<798c>-.15 G 2.816(les. When)94.666 111.6 R .316(all the blocks ha)2.816 F .616
-.15(ve b)-.2 H .316(een initially accounted for).15 F(,)-.4 E F3(fsc)2.816 E
(k)-.2 E F0 .316(checks that the number of free blocks)2.816 F(plus the number\
 of blocks claimed by the inodes equals the total number of blocks in the \214\
le system.)72 123.6 Q .853(If an)97 139.2 R .853
(ything is wrong with the block allocation maps,)-.15 F F3(fsc)3.353 E(k)-.2 E
F0 .853(will reb)3.353 F .852(uild them, based on the list it has)-.2 F
(computed of allocated blocks.)72 151.2 Q 1.52
(The summary information associated with the super)97 166.8 R 1.52
(-block counts the total number of free blocks)-.2 F .6
(within the \214le system.)72 178.8 R F3(Fsc)5.6 E(k)-.2 E F0 .6(compares this\
 count to the number of free blocks it found within the \214le sys-)3.1 F 3.079
(tem. If)72 190.8 R .579(the tw)3.079 F 3.079(oc)-.1 G .579
(ounts do not agree, then)142.536 190.8 R F3(fsc)3.079 E(k)-.2 E F0 .58
(replaces the incorrect count in the summary information by)3.079 F
(the actual free-block count.)72 202.8 Q .687(The summary information counts t\
he total number of free inodes within the \214le system.)97 218.4 R F3(Fsc)
5.686 E(k)-.2 E F0(com-)3.186 E .102(pares this count to the number of free in\
odes it found within the \214le system.)72 230.4 R .103(If the tw)5.103 F 2.603
(oc)-.1 G .103(ounts do not agree,)427.591 230.4 R(then)72 242.4 Q F3(fsc)2.5 E
(k)-.2 E F0(replaces the incorrect count in the summary information by the act\
ual free-inode count.)2.5 E F2 2.5(3.4. Checking)72 266.4 R(the inode state)2.5
E F0 .453(An indi)97 282 R .453(vidual inode is not as lik)-.25 F .453
(ely to be corrupted as the allocation information.)-.1 F(Ho)5.452 E(we)-.25 E
-.15(ve)-.25 G 1.252 -.4(r, b).15 H(ecause).4 E(of the great number of acti)72
294 Q .3 -.15(ve i)-.25 H(nodes, a fe).15 E 2.5(wo)-.25 G 2.5(ft)250.19 294 S
(he inodes are usually corrupted.)258.8 294 Q 1.416
(The list of inodes in the \214le system is check)97 309.6 R 1.416
(ed sequentially starting with inode 2 \(inode 0 marks)-.1 F 1.04
(unused inodes; inode 1 is sa)72 321.6 R -.15(ve)-.2 G 3.54(df).15 G 1.04
(or future generations\) and progressing through the last inode in the \214le)
210.1 321.6 R 2.637(system. The)72 333.6 R .137(state of each inode is check)
2.637 F .138(ed for inconsistencies in)-.1 F -.2(vo)-.4 G .138
(lving format and type, link count, dupli-).2 F
(cate blocks, bad blocks, and inode size.)72 345.6 Q .15
(Each inode contains a mode w)97 361.2 R 2.65(ord. This)-.1 F .15(mode w)2.65 F
.15(ord describes the type and state of the inode.)-.1 F(Inodes)5.15 E .727
(must be one of six types: re)72 373.2 R .728(gular inode, directory inode, sy\
mbolic link inode, special block inode, special)-.15 F .693
(character inode, or sock)72 385.2 R .693(et inode.)-.1 F .692
(Inodes may be found in one of three allocation states: unallocated, allo-)
5.693 F 1.319(cated, and neither unallocated nor allocated.)72 397.2 R 1.319
(This last state suggests an incorrectly formated inode.)6.319 F(An)6.32 E .13
(inode can get in this state if bad data is written into the inode list.)72
409.2 R .129(The only possible correcti)5.129 F .429 -.15(ve a)-.25 H .129
(ction is for).15 F F3(fsc)72 421.2 Q(k)-.2 E F0(is to clear the inode.)2.5 E
F2 2.5(3.5. Inode)72 445.2 R(links)2.5 E F0 1.198
(Each inode counts the total number of directory entries link)97 460.8 R 1.198
(ed to the inode.)-.1 F F3(Fsc)6.198 E(k)-.2 E F0 -.15(ve)3.698 G 1.199
(ri\214es the link).15 F .022(count of each inode by starting at the root of t\
he \214le system, and descending through the directory structure.)72 472.8 R
(The actual link count for each inode is calculated during the descent.)72
484.8 Q .532(If the stored link count is non-zero and the actual link count is\
 zero, then no directory entry appears)97 500.4 R .142(for the inode.)72 512.4
R .142(If this happens,)5.142 F F3(fsc)2.642 E(k)-.2 E F0 .142
(will place the disconnected \214le in the)2.642 F F3(lost+found)2.641 E F0
(directory)2.641 E 5.141(.I)-.65 G 2.641(ft)458.728 512.4 S .141(he stored)
467.479 512.4 R .555
(and actual link counts are non-zero and unequal, a directory entry may ha)72
524.4 R .855 -.15(ve b)-.2 H .555(een added or remo).15 F -.15(ve)-.15 G 3.055
(dw).15 G(ith-)490.11 524.4 Q .265(out the inode being updated.)72 536.4 R .265
(If this happens,)5.265 F F3(fsc)2.765 E(k)-.2 E F0 .265
(replaces the incorrect stored link count by the actual link)2.765 F(count.)72
548.4 Q .098(Each inode contains a list, or pointers to lists \(indirect block\
s\), of all the blocks claimed by the inode.)97 564 R .179
(Since indirect blocks are o)72 576 R .178
(wned by an inode, inconsistencies in indirect blocks directly af)-.25 F .178
(fect the inode that)-.25 F -.25(ow)72 588 S(ns it.).25 E F3(Fsc)97 603.6 Q(k)
-.2 E F0 .563(compares each block number claimed by an inode ag)3.063 F .563
(ainst a list of already allocated blocks.)-.05 F(If)5.564 E .519
(another inode already claims a block number)72 615.6 R 3.018(,t)-.4 G .518
(hen the block number is added to a list of)262.972 615.6 R F3 .518
(duplicate bloc)3.018 F(ks)-.2 E F0(.)A(Otherwise, the list of allocated block\
s is updated to include the block number)72 627.6 Q(.)-.55 E .172
(If there are an)97 643.2 R 2.672(yd)-.15 G .172(uplicate blocks,)165.838 643.2
R F3(fsc)2.672 E(k)-.2 E F0 .173(will perform a partial second pass o)2.672 F
-.15(ve)-.15 G 2.673(rt).15 G .173(he inode list to \214nd the)411.185 643.2 R
.086(inode of the duplicated block.)72 655.2 R .086
(The second pass is needed, since without e)5.086 F .085
(xamining the \214les associated with)-.15 F .353
(these inodes for correct content, not enough information is a)72 667.2 R -.25
(va)-.2 G .354(ilable to determine which inode is corrupted).25 F .204
(and should be cleared.)72 679.2 R .204
(If this condition does arise \(only hardw)5.204 F .204(are f)-.1 F .204
(ailure will cause it\), then the inode with)-.1 F .084
(the earliest modify time is usually incorrect, and should be cleared.)72 691.2
R .085(If this happens,)5.085 F F3(fsc)2.585 E(k)-.2 E F0 .085
(prompts the opera-)2.585 F 1.324(tor to clear both inodes.)72 703.2 R 1.324
(The operator must decide which one should be k)6.324 F 1.324
(ept and which one should be)-.1 F(cleared.)72 715.2 Q EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-7)464.55 48 Q/F2 10/Times-Italic@0 SF
(Fsc)97 84 Q(k)-.2 E F0 .326
(checks the range of each block number claimed by an inode.)2.826 F .327
(If the block number is lo)5.327 F .327(wer than)-.25 F .984(the \214rst data \
block in the \214le system, or greater than the last data block, then the bloc\
k number is a)72 96 R F2(bad)3.483 E(bloc)72 108 Q 2.734(kn)-.2 G(umber)101.194
108 Q F0 5.234(.M)C(an)143.368 108 Q 2.734(yb)-.15 G .235
(ad blocks in an inode are usually caused by an indirect block that w)165.392
108 R .235(as not written to)-.1 F .326
(the \214le system, a condition which can only occur if there has been a hardw)
72 120 R .326(are f)-.1 F 2.825(ailure. If)-.1 F .325(an inode contains)2.825 F
(bad block numbers,)72 132 Q F2(fsc)2.5 E(k)-.2 E F0
(prompts the operator to clear it.)2.5 E/F3 10/Times-Bold@0 SF 2.5(3.6. Inode)
72 156 R(data size)2.5 E F0 .208
(Each inode contains a count of the number of data blocks that it contains.)97
171.6 R .208(The number of actual data)5.208 F .311
(blocks is the sum of the allocated data blocks and the indirect blocks.)72
183.6 R F2(Fsc)5.311 E(k)-.2 E F0 .311(computes the actual number of)2.811 F
1.383(data blocks and compares that block count ag)72 195.6 R 1.383
(ainst the actual number of blocks the inode claims.)-.05 F 1.383(If an)6.383 F
(inode contains an incorrect count)72 207.6 Q F2(fsc)2.5 E(k)-.2 E F0
(prompts the operator to \214x it.)2.5 E .187(Each inode contains a thirty-tw)
97 223.2 R 2.687(ob)-.1 G .187(it size \214eld.)235.315 223.2 R .186
(The size is the number of data bytes in the \214le associ-)5.186 F .529
(ated with the inode.)72 235.2 R .529(The consistenc)5.529 F 3.029(yo)-.15 G
3.029(ft)231.114 235.2 S .529(he byte size \214eld is roughly check)240.253
235.2 R .53(ed by computing from the size)-.1 F .12(\214eld the maximum number\
 of blocks that should be associated with the inode, and comparing that e)72
247.2 R(xpected)-.15 E(block count ag)72 259.2 Q
(ainst the actual number of blocks the inode claims.)-.05 E F3 2.5
(3.7. Checking)72 283.2 R(the data associated with an inode)2.5 E F0 .566
(An inode can directly or indirectly reference three kinds of data blocks.)97
298.8 R .566(All referenced blocks must)5.566 F 1.226(be the same kind.)72
310.8 R 1.225(The three types of data blocks are: plain data blocks, symbolic \
link data blocks, and)6.226 F .543(directory data blocks.)72 322.8 R .544(Plai\
n data blocks contain the information stored in a \214le; symbolic link data b\
locks)5.543 F 1.601(contain the path name stored in a link.)72 334.8 R 1.6
(Directory data blocks contain directory entries.)6.601 F F2(Fsc)6.6 E(k)-.2 E
F0 1.6(can only)4.1 F(check the v)72 346.8 Q(alidity of directory data blocks.)
-.25 E 1.975(Each directory data block is check)97 362.4 R 1.975(ed for se)-.1
F -.15(ve)-.25 G 1.975(ral types of inconsistencies.).15 F 1.975
(These inconsistencies)6.975 F 1.057(include directory inode numbers pointing \
to unallocated inodes, directory inode numbers that are greater)72 374.4 R .204
(than the number of inodes in the \214le system, incorrect directory inode num\
bers for `)72 386.4 R(`)-.74 E F3(.)A F0 1.684 -.74('' a)D .204(nd `).74 F(`)
-.74 E F3(..)A F0 -.74('')C 2.704(,a).74 G .204(nd direc-)467.976 386.4 R .739
(tories that are not attached to the \214le system.)72 398.4 R .739
(If the inode number in a directory data block references an)5.739 F 1.236
(unallocated inode, then)72 410.4 R F2(fsc)3.736 E(k)-.2 E F0 1.236(will remo)
3.736 F 1.536 -.15(ve t)-.15 H 1.236(hat directory entry).15 F 6.236(.A)-.65 G
-.05(ga)337.484 410.4 S 1.236(in, this condition can only arise when).05 F
(there has been a hardw)72 422.4 Q(are f)-.1 E(ailure.)-.1 E .7
(If a directory entry inode number references outside the inode list, then)97
438 R F2(fsc)3.2 E(k)-.2 E F0 .7(will remo)3.2 F 1 -.15(ve t)-.15 H .7
(hat direc-).15 F(tory entry)72 450 Q 5(.T)-.65 G
(his condition occurs if bad data is written into a directory data block.)
124.12 450 Q 1.075(The directory inode number entry for `)97 465.6 R(`)-.74 E
F3(.)A F0 5.055 -.74('' m)D 1.075
(ust be the \214rst entry in the directory data block.).74 F(The)6.076 E 1.387
(inode number for `)72 477.6 R(`)-.74 E F3(.)A F0 5.367 -.74('' m)D 1.386(ust \
reference itself; e.g., it must equal the inode number for the directory data)
.74 F 2.883(block. The)72 489.6 R .383(directory inode number entry for `)2.883
F(`)-.74 E F3(..)A F0 1.863 -.74('' m)D .384
(ust be the second entry in the directory data block.).74 F(Its)5.384 E -.25
(va)72 501.6 S .547(lue must equal the inode number for the parent of the dire\
ctory entry \(or the inode number of the direc-).25 F .297
(tory data block if the directory is the root directory\).)72 513.6 R .297
(If the directory inode numbers are incorrect,)5.297 F F2(fsc)2.798 E(k)-.2 E
F0(will)2.798 E .892(replace them with the correct v)72 525.6 R 3.392
(alues. If)-.25 F .892(there are multiple hard links to a directory)3.392 F
3.391(,t)-.65 G .891(he \214rst one encoun-)422.177 525.6 R 1.415
(tered is considered the real parent to which `)72 537.6 R(`)-.74 E F3(..)A F0
2.896 -.74('' s)D 1.416(hould point;).74 F F2(fsc)3.916 E(k)-.2 E F0 1.416
(recommends deletion for the subse-)3.916 F(quently disco)72 549.6 Q -.15(ve)
-.15 G(red names.).15 E F3 2.5(3.8. File)72 573.6 R(system connecti)2.5 E(vity)
-.1 E F2(Fsc)97 589.2 Q(k)-.2 E F0 .367(checks the general connecti)2.867 F
.367(vity of the \214le system.)-.25 F .366(If directories are not link)5.366 F
.366(ed into the \214le sys-)-.1 F .392(tem, then)72 601.2 R F2(fsc)2.892 E(k)
-.2 E F0 .392(links the directory back into the \214le system in the)2.892 F F2
(lost+found)2.893 E F0(directory)2.893 E 5.393(.T)-.65 G .393
(his condition only)430.984 601.2 R(occurs when there has been a hardw)72 613.2
Q(are f)-.1 E(ailure.)-.1 E/F4 12/Times-Bold@0 SF(Ackno)72 637.2 Q(wledgements)
-.12 E F0 2.915(It)97 652.8 S .415(hank Bill Jo)106.025 652.8 R 1.714 -.65
(y, S)-.1 H .414(am Lef).65 F(\215er)-.25 E 2.914(,R)-.4 G .414
(obert Elz and Dennis Ritchie for their suggestions and help in imple-)224.196
652.8 R 1.522(menting the ne)72 664.8 R 4.022<778c>-.25 G 1.522(le system.)
151.036 664.8 R 1.522
(Thanks also to Robert Henry for his editorial input to get this document)6.522
F(together)72 676.8 Q 5.489(.F)-.55 G .489
(inally we thank our sponsors, the National Science F)117.769 676.8 R .488
(oundation under grant MCS80-05144, and)-.15 F 1.105(the Defense Adv)72 688.8 R
1.105(ance Research Projects Agenc)-.25 F 3.605(y\()-.15 G 1.105
(DoD\) under Arpa Order No. 4031 monitored by Na)277.05 688.8 R -.25(va)-.2 G
(l).25 E
(Electronic System Command under Contract No. N00039-82-C-0235. \(Kirk McK)72
700.8 Q(usick, July 1983\))-.15 E 2.518(Iw)97 716.4 S .018(ould lik)109.968
716.4 R 2.518(et)-.1 G 2.517(ot)150.464 716.4 S .017(hank Larry A. W)160.761
716.4 R .017(ehr for advice that lead to the \214rst v)-.8 F .017(ersion of)
-.15 F F2(fsc)2.517 E(k)-.2 E F0 .017(and Rick B. Brandt)2.517 F(for adapting)
72 728.4 Q F2(fsc)2.5 E(k)-.2 E F0(to UNIX/TS. \(T)2.5 E 2.5(.K)-.74 G -2.1
-.25(ow a)216.24 728.4 T(lski, July 1979\)).25 E EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 237.008(SMM:3-8 The)72 48 R/F1 8/Times-Roman@0 SF(UNIX)
2.5 E F0(File System Check Program)2.5 E/F2 12/Times-Bold@0 SF(Refer)72 84 Q
(ences)-.216 E F0 50.84([Dolotta78] Dolotta,)72 103.2 R 2.022 -.74(T. A)3.042 H
.542(., and Olsson, S. B. eds.,).74 F/F3 10/Times-Italic@0 SF .542(UNIX User')
3.042 F 3.042(sM)-.4 G .542(anual, Edition 1.1)393.21 103.2 R F0 3.043(,J).833
G(anuary)476.79 103.2 Q(1978.)172 115.2 Q([Jo)72 130.8 Q 67.05(y83] Jo)-.1 F
1.47 -.65(y, W)-.1 H .17(., Cooper)-.27 F 2.67(,E)-.4 G .17(., F)246.82 130.8 R
(abry)-.15 E 2.67(,R)-.65 G .17(., Lef)288.86 130.8 R(\215er)-.25 E 2.67(,S)-.4
G .17(., McK)333.82 130.8 R .17(usick, M., and Mosher)-.15 F 2.67(,D)-.4 G 5.17
(.4)464.38 130.8 S(.2BSD)477.05 130.8 Q .307(System Manual,)172 142.8 R F3
(Univer)2.807 E .308(sity of California at Berk)-.1 F(ele)-.1 E(y)-.3 E F0(,)A
F3 .308(Computer Systems Resear)2.808 F -.15(ch)-.37 G(Gr)172 154.8 Q(oup T)
-.45 E(ec)-.92 E(hnical Report)-.15 E F0(#4, 1982.)2.5 E([McK)72 170.4 Q 39.33
(usick84] McK)-.15 F .806(usick, M., Jo)-.15 F 2.106 -.65(y, W)-.1 H .806
(., Lef)-.27 F(\215er)-.25 E 3.306(,S)-.4 G .806(., and F)310.21 170.4 R(abry)
-.15 E 3.306(,R)-.65 G 5.806(.A)371.268 170.4 S -.15(Fa)390.1 170.4 S .805
(st File System for UNIX,).15 F F3 -.3(AC)172 182.4 S 2.5(MT).3 G -.15(ra)
200.32 182.4 S(nsactions on Computer Systems 2).15 E F0 2.5(,3)C 5(.p)353.5
182.4 S(p. 181-197, August 1984.)366 182.4 Q 51.95([Ritchie78] Ritchie,)72 198
R 1.705(D. M., and Thompson, K., The UNIX T)4.205 F 1.706(ime-Sharing System,)
-.35 F F3 1.706(The Bell)4.206 F(System T)172 210 Q(ec)-.92 E(hnical J)-.15 E
(ournal)-.25 E/F4 10/Times-Bold@0 SF(57)2.5 E F0 2.5(,6\()C
(July-August 1978, P)302.33 210 Q(art 2\), pp. 1905-29.)-.15 E 38.06
([Thompson78] Thompson,)72 225.6 R 1.224(K., UNIX Implementation,)3.724 F F3
1.224(The Bell System T)3.724 F(ec)-.92 E 1.223(hnical J)-.15 F(ournal)-.25 E
F4(57)4.556 E F0 3.723(,6)C(\(July-August 1978, P)172 237.6 Q
(art 2\), pp. 1931-46.)-.15 E EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-9)464.55 48 Q/F2 10/Times-Bold@0 SF 2.5
(4. A)72 84 R(ppendix A \255 Fsck Err)-.25 E(or Conditions)-.18 E 2.5(4.1. Con)
72 108 R -.1(ve)-.4 G(ntions).1 E/F3 10/Times-Italic@0 SF(Fsc)97 123.6 Q(k)-.2
E F0 .895(is a multi-pass \214le system check program.)3.395 F .895
(Each \214le system pass in)5.895 F -.2(vo)-.4 G -.1(ke).2 G 3.395(sad).1 G(if)
436.37 123.6 Q .895(ferent Phase of)-.25 F(the)72 135.6 Q F3(fsc)3.324 E(k)-.2
E F0 3.324(program. After)3.324 F .824(the initial setup,)3.324 F F3(fsc)3.323
E(k)-.2 E F0 .823(performs successi)3.323 F 1.123 -.15(ve P)-.25 H .823
(hases o).15 F -.15(ve)-.15 G 3.323(re).15 G .823(ach \214le system, checking)
400.991 135.6 R .327(blocks and sizes, path-names, connecti)72 147.6 R(vity)
-.25 E 2.827(,r)-.65 G .327
(eference counts, and the map of free blocks, \(possibly reb)251.595 147.6 R
(uild-)-.2 E(ing it\), and performs some cleanup.)72 159.6 Q(Normally)72 175.2
Q F3(fsc)2.63 E(k)-.2 E F0 .13(is run non-interacti)2.63 F -.15(ve)-.25 G .13
(ly to).15 F F3(pr)2.63 E(een)-.37 E F0 .13
(the \214le systems after an unclean halt.)2.63 F .13(While preen'ing a \214le)
5.13 F 1.126(system, it will only \214x corruptions that are e)72 187.2 R 1.127
(xpected to occur from an unclean halt.)-.15 F 1.127(These actions are a)6.127
F .768(proper subset of the actions that)72 199.2 R F3(fsc)3.268 E(k)-.2 E F0
.768(will tak)3.268 F 3.267(ew)-.1 G .767(hen it is running interacti)271.081
199.2 R -.15(ve)-.25 G(ly).15 E 5.767(.T)-.65 G .767(hroughout this appendix)
405.246 199.2 R(man)72 211.2 Q 2.594(ye)-.15 G .094(rrors ha)101.104 211.2 R
.394 -.15(ve s)-.2 H -2.15 -.25(ev e).15 H .094
(ral options that the operator can tak).25 F 2.594(e. When)-.1 F .095
(an inconsistenc)2.595 F 2.595(yi)-.15 G 2.595(sd)413.385 211.2 S(etected,)
424.87 211.2 Q F3(fsc)2.595 E(k)-.2 E F0(reports)2.595 E .623
(the error condition to the operator)72 223.2 R 5.623(.I)-.55 G 3.123(far)
221.268 223.2 S .623(esponse is required,)238.614 223.2 R F3(fsc)3.123 E(k)-.2
E F0 .622(prints a prompt message and w)3.123 F .622(aits for a)-.1 F 3.253
(response. When)72 235.2 R .753(preen'ing most errors are f)3.253 F 3.253
(atal. F)-.1 F .753(or those that are e)-.15 F .753(xpected, the response tak)
-.15 F .754(en is noted.)-.1 F .946(This appendix e)72 247.2 R .945(xplains th\
e meaning of each error condition, the possible responses, and the related err\
or)-.15 F(conditions.)72 259.2 Q .982(The error conditions are or)72 274.8 R
-.05(ga)-.18 G .983(nized by the).05 F F3(Phase)3.483 E F0 .983(of the)3.483 F
F3(fsc)3.483 E(k)-.2 E F0 .983(program in which the)3.483 F 3.483(yc)-.15 G
.983(an occur)422.471 274.8 R 5.983(.T)-.55 G .983(he error)471.647 274.8 R(co\
nditions that may occur in more than one Phase will be discussed in initializa\
tion.)72 286.8 Q F2 2.5(4.2. Initialization)72 310.8 R F0 .106
(Before a \214le system check can be performed, certain tables ha)97 326.4 R
.405 -.15(ve t)-.2 H 2.605(ob).15 G 2.605(es)373.12 326.4 S .105
(et up and certain \214les opened.)384.055 326.4 R .299(This section concerns \
itself with the opening of \214les and the initialization of tables.)72 338.4 R
.3(This section lists error)5.3 F .301(conditions resulting from command line \
options, memory requests, opening of \214les, status of \214les, \214le sys-)72
350.4 R .056(tem size checks, and creation of the scratch \214le.)72 362.4 R
.056(All the initialization errors are f)5.056 F .057
(atal when the \214le system is)-.1 F(being preen'ed.)72 374.4 Q F3(C)72 402 Q
F2(option?)2.5 E F3(C)72 414 Q F0 .165(is not a le)2.665 F -.05(ga)-.15 G 2.665
(lo).05 G .165(ption to)140.125 414 R F3(fsc)2.665 E(k)-.2 E F0 2.665(;l)C
-2.25 -.15(eg a)197.37 414 T 2.665(lo).15 G .165
(ptions are \255b, \255c, \255y)221.495 414 R 2.665<2cad>-.65 G .165
(n, and \255p.)315.33 414 R F3(Fsc)5.165 E(k)-.2 E F0 .165
(terminates on this error condi-)2.665 F 2.5(tion. See)72 426 R(the)2.5 E F3
(fsc)2.5 E(k)-.2 E F0(\(8\) manual entry for further detail.)A F2
(cannot alloc NNN bytes f)72 453.6 Q(or blockmap)-.25 E
(cannot alloc NNN bytes f)72 465.6 Q(or fr)-.25 E(eemap)-.18 E
(cannot alloc NNN bytes f)72 477.6 Q(or statemap)-.25 E
(cannot alloc NNN bytes f)72 489.6 Q(or lncntp)-.25 E F3(Fsc)72 501.6 Q(k)-.2 E
F0 1.316 -.55('s r)D .216(equest for memory for its virtual memory tables f).55
F 2.717(ailed. This)-.1 F .217(should ne)2.717 F -.15(ve)-.25 G 2.717(rh).15 G
(appen.)409.346 501.6 Q F3(Fsc)5.217 E(k)-.2 E F0(terminates)2.717 E
(on this error condition.)72 513.6 Q(See a guru.)5 E F2
(Can't open checklist \214le:)72 541.2 Q F3(F)2.5 E F0 .607
(The \214le system checklist \214le)72 553.2 R F3(F)3.107 E F0(\(usually)3.107
E F3(/etc/fstab)3.107 E F0 3.107(\)c)C .606(an not be opened for reading.)
284.066 553.2 R F3(Fsc)5.606 E(k)-.2 E F0 .606(terminates on this)3.106 F
(error condition.)72 565.2 Q(Check access modes of)5 E F3(F)2.5 E F0(.)A F2
(Can't stat r)72 592.8 Q(oot)-.18 E F3(Fsc)72 604.8 Q(k)-.2 E F0 1.416 -.55
('s r)D .316(equest for statistics about the root directory `).55 F(`/')-.74 E
2.816('f)-.74 G 2.816(ailed. This)302.184 604.8 R .316(should ne)2.816 F -.15
(ve)-.25 G 2.816(rh).15 G(appen.)409.148 604.8 Q F3(Fsc)5.316 E(k)-.2 E F0
(terminates)2.816 E(on this error condition.)72 616.8 Q(See a guru.)5 E F2
(Can't stat)72 644.4 Q F3(F)2.5 E F2(Can't mak)72 656.4 Q 2.5(es)-.1 G
(ense out of name)128.56 656.4 Q F3(F)2.5 E(Fsc)72 668.4 Q(k)-.2 E F0 1.57 -.55
('s r)D .47(equest for statistics about the \214le system).55 F F3(F)2.969 E F0
-.1(fa)2.969 G 2.969(iled. When).1 F .469(running manually)2.969 F 2.969(,i)
-.65 G 2.969(ti)416.564 668.4 S .469(gnores this \214le sys-)425.093 668.4 R
(tem and continues checking the ne)72 680.4 Q(xt \214le system gi)-.15 E -.15
(ve)-.25 G 2.5(n. Check).15 F(access modes of)2.5 E F3(F)2.5 E F0(.)A F2
(Can't open)72 708 Q F3(F)2.5 E(Fsc)72 720 Q(k)-.2 E F0 1.536 -.55('s r)D .436
(equest attempt to open the \214le system).55 F F3(F)2.936 E F0 -.1(fa)2.936 G
2.937(iled. When).1 F .437(running manually)2.937 F 2.937(,i)-.65 G 2.937(ti)
405.022 720 S .437(gnores this \214le system)413.519 720 R EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-10 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E(and continues checking the ne)72
84 Q(xt \214le system gi)-.15 E -.15(ve)-.25 G 2.5(n. Check).15 F
(access modes of)2.5 E/F2 10/Times-Italic@0 SF(F)2.5 E F0(.)A F2(F)72 111.6 Q
/F3 10/Times-Bold@0 SF 2.5(:\()C(NO WRITE\))87.27 111.6 Q F0 .081
(Either the \255n \215ag w)72 123.6 R .081(as speci\214ed or)-.1 F F2(fsc)2.581
E(k)-.2 E F0 1.181 -.55('s a)D .08(ttempt to open the \214le system).55 F F2(F)
2.58 E F0 .08(for writing f)2.58 F 2.58(ailed. When)-.1 F(running)2.58 E
(manually)72 135.6 Q 2.5(,a)-.65 G(ll the diagnostics are printed out, b)118.01
135.6 Q(ut no modi\214cations are attempted to \214x them.)-.2 E F3
(\214le is not a block or character de)72 163.2 Q(vice; OK)-.15 E F0 -1.1(Yo)72
175.2 S 2.5(uh)1.1 G -2.25 -.2(av e)95.62 175.2 T(gi)2.7 E -.15(ve)-.25 G(n).15
E F2(fsc)2.5 E(k)-.2 E F0 2.5(ar)2.5 G -.15(eg)164.09 175.2 S
(ular \214le name by mistak).15 E 2.5(e. Check)-.1 F
(the type of the \214le speci\214ed.)2.5 E
(Possible responses to the OK prompt are:)72 190.8 Q 3.61(YES ignore)72 206.4 R
(this error condition.)2.5 E 8.06(NO ignore)72 222 R
(this \214le system and continues checking the ne)2.5 E(xt \214le system gi)
-.15 E -.15(ve)-.25 G(n.).15 E F3(UNDEFINED OPTIMIZA)72 249.6 Q
(TION IN SUPERBLOCK \(SET T)-.95 E 2.5(OD)-.18 G(EF)346.45 249.6 Q -.5(AU)-.9 G
-.92(LT).5 G(\)).92 E F0
(The superblock optimization parameter is neither OPT_TIME nor OPT_SP)72 261.6
Q -.4(AC)-.92 G(E.).4 E(Possible responses to the SET T)72 277.2 Q 2.5(OD)-.18
G(EF)217.37 277.2 Q -.55(AU)-.74 G 1.84 -.92(LT p).55 H(rompt are:).92 E 3.61
(YES The)72 292.8 R .598(superblock is set to request optimization to minimize\
 running time of the system.)3.098 F .598(\(If optimiza-)5.598 F
(tion to minimize disk space utilization is desired, it can be set using)97
304.8 Q F2(tunefs)2.5 E F0(\(8\).\))A 8.06(NO ignore)72 320.4 R
(this error condition.)2.5 E F3(IMPOSSIBLE MINFREE=)72 348 Q F2(D)A F3
(IN SUPERBLOCK \(SET T)2.5 E 2.5(OD)-.18 G(EF)333.11 348 Q -.5(AU)-.9 G -.92
(LT).5 G(\)).92 E F0
(The superblock minimum space percentage is greater than 99% or less then 0%.)
72 360 Q(Possible responses to the SET T)72 375.6 Q 2.5(OD)-.18 G(EF)217.37
375.6 Q -.55(AU)-.74 G 1.84 -.92(LT p).55 H(rompt are:).92 E 3.61(YES The)72
391.2 R 2.019(minfree parameter is set to 10%.)4.519 F 2.018
(\(If some other percentage is desired, it can be set using)7.018 F F2(tunefs)
97 403.2 Q F0(\(8\).\))A 8.06(NO ignore)72 418.8 R(this error condition.)2.5 E
F3(IMPOSSIBLE INTERLEA)72 446.4 Q(VE=)-1.45 E F2(D)A F3(IN SUPERBLOCK \(SET T)
2.5 E 2.5(OD)-.18 G(EF)350.56 446.4 Q -.5(AU)-.9 G -.92(LT).5 G(\)).92 E F0
(The \214le system interlea)72 458.4 Q .3 -.15(ve i)-.2 H 2.5(sl).15 G
(ess than or equal to zero.)189.14 458.4 Q(Possible responses to the SET T)72
474 Q 2.5(OD)-.18 G(EF)217.37 474 Q -.55(AU)-.74 G 1.84 -.92(LT p).55 H
(rompt are:).92 E 3.61(YES The)72 489.6 R(interlea)2.5 E .3 -.15(ve p)-.2 H
(arameter is set to 1.).15 E 8.06(NO ignore)72 505.2 R(this error condition.)
2.5 E F3(IMPOSSIBLE NPSECT=)72 532.8 Q F2(D)A F3(IN SUPERBLOCK \(SET T)2.5 E
2.5(OD)-.18 G(EF)325.34 532.8 Q -.5(AU)-.9 G -.92(LT).5 G(\)).92 E F0
(The number of ph)72 544.8 Q
(ysical sectors per track is less than the number of usable sectors per track.)
-.05 E(Possible responses to the SET T)72 560.4 Q 2.5(OD)-.18 G(EF)217.37 560.4
Q -.55(AU)-.74 G 1.84 -.92(LT p).55 H(rompt are:).92 E 3.61(YES The)72 576 R
(npsect parameter is set to the number of usable sectors per track.)2.5 E 8.06
(NO ignore)72 591.6 R(this error condition.)2.5 E(One of the follo)72 619.2 Q
(wing messages will appear:)-.25 E F3(MA)72 631.2 Q(GIC NUMBER WR)-.55 E(ONG)
-.3 E(NCG OUT OF RANGE)72 643.2 Q(CPG OUT OF RANGE)72 655.2 Q(NCYL DOES NO)72
667.2 Q 2.5(TJ)-.4 G(IVE WITH NCG*CPG)161.33 667.2 Q(SIZE PREPOSTER)72 679.2 Q
(OUSL)-.3 E 2.5(YL)-.92 G(ARGE)199.7 679.2 Q(TRASHED V)72 691.2 Q
(ALUES IN SUPER BLOCK)-1.35 E F0(and will be follo)72 703.2 Q
(wed by the message:)-.25 E F2(F)72 715.2 Q F3 2.5(:B)C(AD SUPER BLOCK:)90.31
715.2 Q F2(B)2.5 E F3(USE -b OPTION T)72 727.2 Q 2.5(OF)-.18 G(SCK T)170.17
727.2 Q 2.5(OS)-.18 G(PECIFY LOCA)215.56 727.2 Q(TION OF AN AL)-.95 E(TERN)-.92
E -.95(AT)-.2 G(E).95 E EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-11)459.55 48 Q/F2 10/Times-Bold@0 SF
(SUPER-BLOCK T)72 84 Q 2.5(OS)-.18 G(UPPL)169.06 84 Q 2.5(YN)-.92 G
(EEDED INFORMA)211.19 84 Q(TION; SEE fsck\(8\).)-.95 E F0 .537
(The super block has been corrupted.)72 96 R .537(An alternati)5.537 F .837
-.15(ve s)-.25 H .537(uper block must be selected from among those listed).15 F
(by)72 108 Q/F3 10/Times-Italic@0 SF(ne)2.899 E(wfs)-.15 E F0 .399
(\(8\) when the \214le system w)2.899 F .398(as created.)-.1 F -.15(Fo)5.398 G
2.898<728c>.15 G .398(le systems with a blocksize less than 32K, specifying)
288.336 108 R(\255b 32 is a good \214rst choice.)72 120 Q F2(INTERN)72 147.6 Q
(AL INCONSISTENCY)-.2 E(:)-.92 E F3(M)2.5 E(Fsc)72 159.6 Q(k)-.2 E F0 1.1 -.55
('s h)D(as had an internal panic, whose message is speci\214ed as).55 E F3(M)
2.5 E F0 5(.T)C(his should ne)348.69 159.6 Q -.15(ve)-.25 G 2.5(rh).15 G 2.5
(appen. See)421.34 159.6 R 2.5(ag)2.5 G(uru.)481.6 159.6 Q F2(CAN NO)72 187.2 Q
2.5(TS)-.4 G(EEK: BLK)125.49 187.2 Q F3(B)2.5 E F2(\(CONTINUE\))2.5 E F3(Fsc)72
199.2 Q(k)-.2 E F0 1.755 -.55('s r)D .655(equest for mo).55 F .655
(ving to a speci\214ed block number)-.15 F F3(B)3.155 E F0 .655
(in the \214le system f)3.155 F 3.155(ailed. This)-.1 F .655(should ne)3.155 F
-.15(ve)-.25 G 3.155(rh).15 G(ap-)491.23 199.2 Q 2.5(pen. See)72 211.2 R 2.5
(ag)2.5 G(uru.)122.82 211.2 Q(Possible responses to the CONTINUE prompt are:)72
226.8 Q 3.61(YES attempt)72 242.4 R .256
(to continue to run the \214le system check.)2.756 F .256(Often, ho)5.256 F(we)
-.25 E -.15(ve)-.25 G 2.755(rt).15 G .255(he problem will persist.)363.575
242.4 R .255(This error)5.255 F .175(condition will not allo)97 254.4 R 2.675
(wac)-.25 G .175(omplete check of the \214le system.)207.345 254.4 R 2.675(As)
5.175 G .175(econd run of)358.83 254.4 R F3(fsc)2.676 E(k)-.2 E F0 .176
(should be made to)2.676 F .004(re-check this \214le system.)97 266.4 R .004
(If the block w)5.004 F .003(as part of the virtual memory b)-.1 F(uf)-.2 E
.003(fer cache,)-.25 F F3(fsc)2.503 E(k)-.2 E F0 .003(will terminate)2.503 F
(with the message `)97 278.4 Q(`F)-.74 E(atal I/O error')-.15 E('.)-.74 E 8.06
(NO terminate)72 294 R(the program.)2.5 E F2(CAN NO)72 321.6 Q 2.5(TR)-.4 G
(EAD: BLK)127.15 321.6 Q F3(B)2.5 E F2(\(CONTINUE\))2.5 E F3(Fsc)72 333.6 Q(k)
-.2 E F0 1.622 -.55('s r)D .522(equest for reading a speci\214ed block number)
.55 F F3(B)3.022 E F0 .522(in the \214le system f)3.022 F 3.023(ailed. This)-.1
F .523(should ne)3.023 F -.15(ve)-.25 G 3.023(rh).15 G(appen.)477.62 333.6 Q
(See a guru.)72 345.6 Q(Possible responses to the CONTINUE prompt are:)72 361.2
Q 3.61(YES attempt)72 376.8 R(to continue to run the \214le system check.)2.5 E
(It will retry the read and print out the message:)5 E F2(THE FOLLO)97 388.8 Q
(WING SECT)-.5 E(ORS COULD NO)-.18 E 2.5(TB)-.4 G 2.5(ER)304.57 388.8 S(EAD:)
320.96 388.8 Q F3(N)2.5 E F0(where)97 400.8 Q F3(N)2.718 E F0 .218
(indicates the sectors that could not be read.)2.718 F(If)5.218 E F3(fsc)2.718
E(k)-.2 E F0 -2.15 -.25(ev e)2.718 H 2.718(rt).25 G .218
(ries to write back one of the blocks)362.224 400.8 R(on which the read f)97
412.8 Q(ailed it will print the message:)-.1 E F2(WRITING ZER)97 424.8 Q
(O'ED BLOCK)-.3 E F3(N)2.5 E F2 .36 -.18(TO D)2.5 H(ISK).18 E F0(where)97 436.8
Q F3(N)2.895 E F0 .395(indicates the sector that w)2.895 F .396
(as written with zero')-.1 F 2.896(s. If)-.55 F .396(the disk is e)2.896 F .396
(xperiencing hardw)-.15 F .396(are prob-)-.1 F .69
(lems, the problem will persist.)97 448.8 R .69
(This error condition will not allo)5.69 F 3.19(wac)-.25 G .69
(omplete check of the \214le sys-)383.07 448.8 R 3.118(tem. A)97 460.8 R .618
(second run of)3.118 F F3(fsc)3.118 E(k)-.2 E F0 .618
(should be made to re-check this \214le system.)3.118 F .619(If the block w)
5.619 F .619(as part of the)-.1 F(virtual memory b)97 472.8 Q(uf)-.2 E
(fer cache,)-.25 E F3(fsc)2.5 E(k)-.2 E F0(will terminate with the message `)
2.5 E(`F)-.74 E(atal I/O error')-.15 E('.)-.74 E 8.06(NO terminate)72 488.4 R
(the program.)2.5 E F2(CAN NO)72 516 Q 2.5(TW)-.4 G(RITE: BLK)129.93 516 Q F3
(B)2.5 E F2(\(CONTINUE\))2.5 E F3(Fsc)72 528 Q(k)-.2 E F0 1.386 -.55('s r)D
.286(equest for writing a speci\214ed block number).55 F F3(B)2.786 E F0 .286
(in the \214le system f)2.786 F 2.786(ailed. The)-.1 F .285
(disk is write-protected;)2.786 F(check the write protect lock on the dri)72
540 Q -.15(ve)-.25 G 5(.I).15 G 2.5(ft)243.78 540 S
(hat is not the problem, see a guru.)252.39 540 Q
(Possible responses to the CONTINUE prompt are:)72 555.6 Q 3.61(YES attempt)72
571.2 R .731(to continue to run the \214le system check.)3.231 F .731
(The write operation will be retried with the f)5.731 F(ailed)-.1 E
(blocks indicated by the message:)97 583.2 Q F2(THE FOLLO)97 595.2 Q(WING SECT)
-.5 E(ORS COULD NO)-.18 E 2.5(TB)-.4 G 2.5(EW)304.57 595.2 S(RITTEN:)323.74
595.2 Q F3(N)2.5 E F0(where)97 607.2 Q F3(N)3.445 E F0 .945
(indicates the sectors that could not be written.)3.445 F .944
(If the disk is e)5.944 F .944(xperiencing hardw)-.15 F .944(are prob-)-.1 F
.69(lems, the problem will persist.)97 619.2 R .69
(This error condition will not allo)5.69 F 3.19(wac)-.25 G .69
(omplete check of the \214le sys-)383.07 619.2 R 3.119(tem. A)97 631.2 R .619
(second run of)3.119 F F3(fsc)3.119 E(k)-.2 E F0 .619
(should be made to re-check this \214le system.)3.119 F .618(If the block w)
5.618 F .618(as part of the)-.1 F(virtual memory b)97 643.2 Q(uf)-.2 E
(fer cache,)-.25 E F3(fsc)2.5 E(k)-.2 E F0(will terminate with the message `)
2.5 E(`F)-.74 E(atal I/O error')-.15 E('.)-.74 E 8.06(NO terminate)72 658.8 R
(the program.)2.5 E F2(bad inode number DDD to ginode)72 686.4 Q F0 .159
(An internal error has attempted to read non-e)72 698.4 R .159(xistent inode)
-.15 F F3(DDD)2.659 E F0 5.159(.T)C .16(his error causes)342.83 698.4 R F3(fsc)
2.66 E(k)-.2 E F0 .16(to e)2.66 F 2.66(xit. See)-.15 F 2.66(ag)2.66 G(uru.)
488.17 698.4 Q EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-12 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E/F2 10/Times-Bold@0 SF 2.5
(4.3. Phase)72 84 R 2.5(1\255C)2.5 G(heck Blocks and Sizes)142.42 84 Q F0 2.05
(This phase concerns itself with the inode list.)97 99.6 R 2.049
(This section lists error conditions resulting from)7.049 F .054
(checking inode types, setting up the zero-link-count table, e)72 111.6 R .055
(xamining inode block numbers for bad or dupli-)-.15 F .056
(cate blocks, checking inode size, and checking inode format.)72 123.6 R .056
(All errors in this phase e)5.056 F(xcept)-.15 E F2(INCORRECT)2.556 E .25
(BLOCK COUNT)72 135.6 R F0(and)2.75 E F2 -.74(PA)2.75 G -.4(RT).74 G(IALL).4 E
2.75(YT)-.92 G -.3(RU)233.17 135.6 S(NCA).3 E .25(TED INODE)-.95 F F0 .25
(are f)2.75 F .25(atal if the \214le system is being preen'ed.)-.1 F F2(UNKNO)
72 163.2 Q(WN FILE TYPE I=)-.5 E/F3 10/Times-Italic@0 SF(I)A F2(\(CLEAR\))2.5 E
F0 .393(The mode w)72 175.2 R .393(ord of the inode)-.1 F F3(I)2.893 E F0 .392
(indicates that the inode is not a special block inode, special character inod\
e,)2.893 F(sock)72 187.2 Q(et inode, re)-.1 E
(gular inode, symbolic link, or directory inode.)-.15 E
(Possible responses to the CLEAR prompt are:)72 202.8 Q 3.61(YES de-allocate)72
218.4 R(inode)2.856 E F3(I)2.856 E F0 .356(by zeroing its contents.)2.856 F
.356(This will al)5.356 F -.1(wa)-.1 G .357(ys in).1 F -.2(vo)-.4 G .557 -.1
(ke t).2 H .357(he UN).1 F(ALLOCA)-.35 E .357(TED error con-)-1.11 F
(dition in Phase 2 for each directory entry pointing to this inode.)97 230.4 Q
8.06(NO ignore)72 246 R(this error condition.)2.5 E F2 -.74(PA)72 273.6 S -.4
(RT).74 G(IALL).4 E 2.5(YT)-.92 G -.3(RU)138 273.6 S(NCA).3 E(TED INODE I=)-.95
E F3(I)A F2(\(SAL)2.5 E -.35 -1.35(VA G)-.92 H(E\))1.35 E F3(Fsc)72 285.6 Q(k)
-.2 E F0 1.453(has found inode)3.953 F F3(I)3.953 E F0 1.452
(whose size is shorter than the number of blocks allocated to it.)3.952 F 1.452
(This condition)6.452 F .181(should only occur if the system crashes while in \
the midst of truncating a \214le.)72 297.6 R .181
(When preen'ing the \214le sys-)5.181 F(tem,)72 309.6 Q F3(fsc)2.5 E(k)-.2 E F0
(completes the truncation to the speci\214ed size.)2.5 E
(Possible responses to SAL)72 325.2 Q -.2 -1.35(VA G)-1 H 2.5(Ea)1.35 G(re:)
210.35 325.2 Q 3.61(YES complete)72 340.8 R
(the truncation to the size speci\214ed in the inode.)2.5 E 8.06(NO ignore)72
356.4 R(this error condition.)2.5 E F2(LINK COUNT T)72 384 Q(ABLE O)-.9 E
(VERFLO)-.5 E 2.5(W\()-.5 G(CONTINUE\))238.45 384 Q F0 .51
(An internal table for)72 396 R F3(fsc)3.01 E(k)-.2 E F0 .51(containing alloca\
ted inodes with a link count of zero cannot allocate more mem-)3.01 F(ory)72
408 Q 5(.I)-.65 G(ncrease the virtual memory for)95.51 408 Q F3(fsc)2.5 E(k)-.2
E F0(.)A(Possible responses to the CONTINUE prompt are:)72 423.6 Q 3.61
(YES continue)72 439.2 R .646(with the program.)3.146 F .647
(This error condition will not allo)5.647 F 3.147(wac)-.25 G .647
(omplete check of the \214le system.)369.115 439.2 R 3.213(As)97 451.2 S .713
(econd run of)111.323 451.2 R F3(fsc)3.213 E(k)-.2 E F0 .713
(should be made to re-check this \214le system.)3.213 F .712
(If another allocated inode with a)5.713 F
(zero link count is found, this error condition is repeated.)97 463.2 Q 8.06
(NO terminate)72 478.8 R(the program.)2.5 E F3(B)72 506.4 Q F2 -.3(BA)2.5 G 2.5
(DI).3 G(=)107.81 506.4 Q F3(I)A F0(Inode)72 518.4 Q F3(I)2.596 E F0 .096
(contains block number)2.596 F F3(B)2.596 E F0 .097(with a number lo)2.596 F
.097(wer than the number of the \214rst data block in the \214le sys-)-.25 F
1.066(tem or greater than the number of the last block in the \214le system.)72
530.4 R 1.065(This error condition may in)6.066 F -.2(vo)-.4 G 1.265 -.1(ke t)
.2 H(he).1 E F2 .792(EXCESSIVE B)72 542.4 R .792(AD BLKS)-.3 F F0 .792
(error condition in Phase 1 \(see ne)3.292 F .792(xt paragraph\) if inode)-.15
F F3(I)3.293 E F0 .793(has too man)3.293 F 3.293(yb)-.15 G(lock)486.78 542.4 Q
.347(numbers outside the \214le system range.)72 554.4 R .347
(This error condition will al)5.347 F -.1(wa)-.1 G .346(ys in).1 F -.2(vo)-.4 G
.546 -.1(ke t).2 H(he).1 E F2 -.3(BA)2.846 G(D/DUP).3 E F0 .346(error condi-)
2.846 F(tion in Phase 2 and Phase 4.)72 566.4 Q F2(EXCESSIVE B)72 594 Q
(AD BLKS I=)-.3 E F3(I)A F2(\(CONTINUE\))2.5 E F0 .576(There is more than a to\
lerable number \(usually 10\) of blocks with a number lo)72 606 R .576
(wer than the number of the)-.25 F .352(\214rst data block in the \214le syste\
m or greater than the number of last block in the \214le system associated wit\
h)72 618 R(inode)72 630 Q F3(I)2.5 E F0(.)A
(Possible responses to the CONTINUE prompt are:)72 645.6 Q 3.61(YES ignore)72
661.2 R .685
(the rest of the blocks in this inode and continue checking with the ne)3.185 F
.686(xt inode in the \214le sys-)-.15 F 3.288(tem. This)97 673.2 R .788
(error condition will not allo)3.288 F 3.287(wac)-.25 G .787
(omplete check of the \214le system.)277.48 673.2 R 3.287(As)5.787 G .787
(econd run of)433.249 673.2 R F3(fsc)3.287 E(k)-.2 E F0
(should be made to re-check this \214le system.)97 685.2 Q 8.06(NO terminate)72
700.8 R(the program.)2.5 E EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-13)459.55 48 Q/F2 10/Times-Bold@0 SF -.3
(BA)72 84 S 2.5(DS).3 G -.9(TA)100.87 84 S(TE DDD T)-.05 E 2.5(OB)-.18 G(LKERR)
176.35 84 Q F0 1.034(An internal error has scrambled)72 96 R/F3 10
/Times-Italic@0 SF(fsc)3.534 E(k)-.2 E F0 2.134 -.55('s s)D 1.034
(tate map to ha).55 F 1.334 -.15(ve t)-.2 H 1.035(he impossible v).15 F(alue)
-.25 E F3(DDD)3.535 E F0(.)A F3(Fsc)6.035 E(k)-.2 E F0 -.15(ex)3.535 G 1.035
(its immedi-).15 F(ately)72 108 Q 5(.S)-.65 G(ee a guru.)103.85 108 Q F3(B)72
135.6 Q F2(DUP I=)2.5 E F3(I)A F0(Inode)72 147.6 Q F3(I)2.647 E F0 .147
(contains block number)2.647 F F3(B)2.647 E F0 .146
(that is already claimed by another inode.)2.647 F .146
(This error condition may in)5.146 F -.2(vo)-.4 G -.1(ke).2 G(the)72 159.6 Q F2
.699(EXCESSIVE DUP BLKS)3.199 F F0 .699(error condition in Phase 1 if inode)
3.199 F F3(I)3.2 E F0 .7(has too man)3.2 F 3.2(yb)-.15 G .7
(lock numbers claimed)414.28 159.6 R 1.037(by other inodes.)72 171.6 R 1.036
(This error condition will al)6.037 F -.1(wa)-.1 G 1.036(ys in).1 F -.2(vo)-.4
G 1.236 -.1(ke P).2 H 1.036(hase 1b and the).1 F F2 -.3(BA)3.536 G(D/DUP).3 E
F0 1.036(error condition in)3.536 F(Phase 2 and Phase 4.)72 183.6 Q F2
(EXCESSIVE DUP BLKS I=)72 211.2 Q F3(I)A F2(\(CONTINUE\))2.5 E F0(There is mor\
e than a tolerable number \(usually 10\) of blocks claimed by other inodes.)72
223.2 Q(Possible responses to the CONTINUE prompt are:)72 238.8 Q 3.61
(YES ignore)72 254.4 R .685
(the rest of the blocks in this inode and continue checking with the ne)3.185 F
.686(xt inode in the \214le sys-)-.15 F 3.288(tem. This)97 266.4 R .788
(error condition will not allo)3.288 F 3.287(wac)-.25 G .787
(omplete check of the \214le system.)277.48 266.4 R 3.287(As)5.787 G .787
(econd run of)433.249 266.4 R F3(fsc)3.287 E(k)-.2 E F0
(should be made to re-check this \214le system.)97 278.4 Q 8.06(NO terminate)72
294 R(the program.)2.5 E F2(DUP T)72 321.6 Q(ABLE O)-.9 E(VERFLO)-.5 E 2.5(W\()
-.5 G(CONTINUE\))194.83 321.6 Q F0 .552(An internal table in)72 333.6 R F3(fsc)
3.052 E(k)-.2 E F0 .552(containing duplicate block numbers cannot allocate an)
3.052 F 3.052(ym)-.15 G .552(ore space.)409.334 333.6 R .552(Increase the)5.552
F(amount of virtual memory a)72 345.6 Q -.25(va)-.2 G(ilable to).25 E F3(fsc)
2.5 E(k)-.2 E F0(.)A(Possible responses to the CONTINUE prompt are:)72 361.2 Q
3.61(YES continue)72 376.8 R .647(with the program.)3.147 F .647
(This error condition will not allo)5.647 F 3.147(wac)-.25 G .647
(omplete check of the \214le system.)369.117 376.8 R 2.61(As)97 388.8 S .11
(econd run of)110.72 388.8 R F3(fsc)2.61 E(k)-.2 E F0 .111
(should be made to re-check this \214le system.)2.61 F .111
(If another duplicate block is found,)5.111 F
(this error condition will repeat.)97 400.8 Q 8.06(NO terminate)72 416.4 R
(the program.)2.5 E F2 -.74(PA)72 444 S -.4(RT).74 G(IALL).4 E 2.5(YA)-.92 G
(LLOCA)138.55 444 Q(TED INODE I=)-.95 E F3(I)A F2(\(CLEAR\))2.5 E F0(Inode)72
456 Q F3(I)2.5 E F0(is neither allocated nor unallocated.)2.5 E
(Possible responses to the CLEAR prompt are:)72 471.6 Q 3.61(YES de-allocate)72
487.2 R(inode)2.5 E F3(I)2.5 E F0(by zeroing its contents.)2.5 E 8.06
(NO ignore)72 502.8 R(this error condition.)2.5 E F2(INCORRECT BLOCK COUNT I=)
72 530.4 Q F3(I)A F2(\()2.5 E F3(X)A F2(should be)2.5 E F3(Y)2.5 E F2 2.5(\)\()
C(CORRECT\))298.27 530.4 Q F0(The block count for inode)72 542.4 Q F3(I)2.5 E
F0(is)2.5 E F3(X)2.5 E F0(blocks, b)2.5 E(ut should be)-.2 E F3(Y)2.5 E F0 2.5
(blocks. When)2.5 F(preen'ing the count is corrected.)2.5 E
(Possible responses to the CORRECT prompt are:)72 558 Q 3.61(YES replace)72
573.6 R(the block count of inode)2.5 E F3(I)2.5 E F0(with)2.5 E F3(Y)2.5 E F0
(.)A 8.06(NO ignore)72 589.2 R(this error condition.)2.5 E F2 2.5(4.4. Phase)72
613.2 R(1B: Rescan f)2.5 E(or Mor)-.25 E 2.5(eD)-.18 G(ups)217.93 613.2 Q F0
.37(When a duplicate block is found in the \214le system, the \214le system is\
 rescanned to \214nd the inode that)97 628.8 R(pre)72 640.8 Q
(viously claimed that block.)-.25 E
(This section lists the error condition when the duplicate block is found.)5 E
F3(B)72 668.4 Q F2(DUP I=)2.5 E F3(I)A F0(Inode)72 680.4 Q F3(I)2.682 E F0 .182
(contains block number)2.682 F F3(B)2.682 E F0 .182
(that is already claimed by another inode.)2.682 F .183
(This error condition will al)5.183 F -.1(wa)-.1 G(ys).1 E(in)72 692.4 Q -.2
(vo)-.4 G .244 -.1(ke t).2 H(he).1 E F2 -.3(BA)2.544 G(D/DUP).3 E F0 .044
(error condition in Phase 2.)2.544 F -1.1(Yo)5.043 G 2.543(uc)1.1 G .043
(an determine which inodes ha)296.652 692.4 R .343 -.15(ve ove)-.2 H .043
(rlapping blocks).15 F(by e)72 704.4 Q
(xamining this error condition and the DUP error condition in Phase 1.)-.15 E
EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-14 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E/F2 10/Times-Bold@0 SF 2.5
(4.5. Phase)72 84 R 2.5(2\255C)2.5 G(heck P)142.42 84 Q(athnames)-.1 E F0 .49
(This phase concerns itself with remo)97 99.6 R .49
(ving directory entries pointing to error conditioned inodes from)-.15 F .438
(Phase 1 and Phase 1b)72 111.6 R 5.438(.T)-.4 G .438(his section lists error c\
onditions resulting from root inode mode and status, direc-)173.5 111.6 R 1.073
(tory inode pointers in range, and directory entries pointing to bad inodes, a\
nd directory inte)72 123.6 R 1.074(grity checks.)-.15 F .103
(All errors in this phase are f)72 135.6 R .103
(atal if the \214le system is being preen'ed, e)-.1 F .102
(xcept for directories not being a multi-)-.15 F(ple of the blocks size and e)
72 147.6 Q(xtraneous hard links.)-.15 E F2 -.3(RO)72 175.2 S .8 -.4(OT I).3 H
(NODE UN).4 E(ALLOCA)-.2 E(TED \(ALLOCA)-.95 E(TE\))-.95 E F0
(The root inode \(usually inode number 2\) has no allocate mode bits.)72 187.2
Q(This should ne)5 E -.15(ve)-.25 G 2.5(rh).15 G(appen.)424.06 187.2 Q
(Possible responses to the ALLOCA)72 202.8 Q(TE prompt are:)-1.11 E 3.61
(YES allocate)72 218.4 R .678(inode 2 as the root inode.)3.178 F .679
(The \214les and directories usually found in the root will be reco)5.678 F(v-)
-.15 E .023(ered in Phase 3 and put into)97 230.4 R/F3 10/Times-Italic@0 SF
(lost+found)2.523 E F0 5.023(.I)C 2.523(ft)265.594 230.4 S .022
(he attempt to allocate the root f)274.227 230.4 R(ails,)-.1 E F3(fsc)2.522 E
(k)-.2 E F0 .022(will e)2.522 F .022(xit with the)-.15 F(message:)97 242.4 Q F2
(CANNO)97 254.4 Q 2.5(TA)-.4 G(LLOCA)149.65 254.4 Q(TE R)-.95 E(OO)-.3 E 2.5
(TI)-.4 G(NODE)235.24 254.4 Q F0(.)A(NO)72 270 Q F3(fsc)97 270 Q(k)-.2 E F0
(will e)2.5 E(xit.)-.15 E F2 -.3(RO)72 297.6 S .8 -.4(OT I).3 H(NODE NO).4 E
2.5(TD)-.4 G(IRECT)169.52 297.6 Q(OR)-.18 E 2.5(Y\()-.35 G(REALLOCA)228.71
297.6 Q(TE\))-.95 E F0
(The root inode \(usually inode number 2\) is not directory inode type.)72
309.6 Q(Possible responses to the REALLOCA)72 325.2 Q(TE prompt are:)-1.11 E
3.61(YES clear)72 340.8 R .416(the e)2.916 F .416
(xisting contents of the root inode and reallocate it.)-.15 F .417
(The \214les and directories usually found)5.416 F .806
(in the root will be reco)97 352.8 R -.15(ve)-.15 G .806
(red in Phase 3 and put into).15 F F3(lost+found)3.306 E F0 5.806(.I)C 3.306
(ft)371.408 352.8 S .805(he attempt to allocate the root)380.824 352.8 R -.1
(fa)97 364.8 S(ils,).1 E F3(fsc)2.5 E(k)-.2 E F0(will e)2.5 E
(xit with the message:)-.15 E F2(CANNO)97 376.8 Q 2.5(TA)-.4 G(LLOCA)149.65
376.8 Q(TE R)-.95 E(OO)-.3 E 2.5(TI)-.4 G(NODE)235.24 376.8 Q F0(.)A(NO)72
392.4 Q F3(fsc)97 392.4 Q(k)-.2 E F0(will then prompt with)2.5 E F2(FIX)2.5 E
F0(Possible responses to the FIX prompt are:)72 408 Q 3.61(YES replace)72 423.6
R .012(the root inode')2.512 F 2.512(st)-.55 G .013(ype to be a directory)
195.918 423.6 R 5.013(.I)-.65 G 2.513(ft)288.363 423.6 S .013(he root inode')
296.986 423.6 R 2.513(sd)-.55 G .013(ata blocks are not directory blocks,)
363.965 423.6 R(man)97 435.6 Q 2.5(ye)-.15 G(rror conditions will be produced.)
126.01 435.6 Q 8.06(NO terminate)72 451.2 R(the program.)2.5 E F2(DUPS/B)72
478.8 Q(AD IN R)-.3 E(OO)-.3 E 2.5(TI)-.4 G(NODE \(REALLOCA)172.95 478.8 Q
(TE\))-.95 E F0 .492(Phase 1 or Phase 1b ha)72 490.8 R .792 -.15(ve f)-.2 H
.492(ound duplicate blocks or bad blocks in the root inode \(usually inode num\
ber 2\)).15 F(for the \214le system.)72 502.8 Q
(Possible responses to the REALLOCA)72 518.4 Q(TE prompt are:)-1.11 E 3.61
(YES clear)72 534 R .416(the e)2.916 F .416
(xisting contents of the root inode and reallocate it.)-.15 F .417
(The \214les and directories usually found)5.416 F .806
(in the root will be reco)97 546 R -.15(ve)-.15 G .806
(red in Phase 3 and put into).15 F F3(lost+found)3.306 E F0 5.806(.I)C 3.306
(ft)371.408 546 S .805(he attempt to allocate the root)380.824 546 R -.1(fa)97
558 S(ils,).1 E F3(fsc)2.5 E(k)-.2 E F0(will e)2.5 E(xit with the message:)-.15
E F2(CANNO)97 570 Q 2.5(TA)-.4 G(LLOCA)149.65 570 Q(TE R)-.95 E(OO)-.3 E 2.5
(TI)-.4 G(NODE)235.24 570 Q F0(.)A(NO)72 585.6 Q F3(fsc)97 585.6 Q(k)-.2 E F0
(will then prompt with)2.5 E F2(CONTINUE)2.5 E F0(.)A
(Possible responses to the CONTINUE prompt are:)72 601.2 Q 3.61(YES ignore)72
616.8 R(the)2.555 E F2(DUPS/B)2.555 E(AD)-.3 E F0 .055(error condition in the \
root inode and attempt to continue to run the \214le system)2.555 F 2.5
(check. If)97 628.8 R
(the root inode is not correct, then this may result in man)2.5 E 2.5(yo)-.15 G
(ther error conditions.)373.2 628.8 Q 8.06(NO terminate)72 644.4 R
(the program.)2.5 E F2 -.2(NA)72 672 S(ME T).2 E(OO LONG)-.18 E F3(F)2.5 E F0
.219(An e)72 684 R(xcessi)-.15 E -.15(ve)-.25 G .219
(ly long path name has been found.).15 F .218
(This usually indicates loops in the \214le system name space.)5.218 F 2.146
(This can occur if the super user has made circular links to directories.)72
696 R 2.147(The of)7.147 F 2.147(fending links must be)-.25 F(remo)72 708 Q
-.15(ve)-.15 G 2.5(d\().15 G(by a guru\).)112.52 708 Q EP
%%Page: 15 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-15)459.55 48 Q/F2 10/Times-Bold@0 SF 2.5
(IO)72 84 S(UT OF RANGE I=)86.17 84 Q/F3 10/Times-Italic@0 SF(I)A F2 -.2(NA)2.5
G(ME=).2 E F3(F)A F2(\(REMO)2.5 E(VE\))-.5 E F0 2.5(Ad)72 96 S(irectory entry)
86.72 96 Q F3(F)2.5 E F0(has an inode number)2.5 E F3(I)2.5 E F0
(that is greater than the end of the inode list.)2.5 E
(Possible responses to the REMO)72 111.6 Q(VE prompt are:)-.5 E 3.61(YES the)72
127.2 R(directory entry)2.5 E F3(F)2.5 E F0(is remo)2.5 E -.15(ve)-.15 G(d.).15
E 8.06(NO ignore)72 142.8 R(this error condition.)2.5 E F2(UN)72 170.4 Q
(ALLOCA)-.2 E(TED I=)-.95 E F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)
2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3 2.5(Tt)C(ype)356.64 170.4
Q F2(=)A F3(F)A F2(\(REMO)2.5 E(VE\))-.5 E F0 2.941(Ad)72 182.4 S .441
(irectory or \214le entry)87.161 182.4 R F3(F)2.941 E F0 .441
(points to an unallocated inode)2.941 F F3(I)2.94 E F0 5.44(.T)C .44(he o)
322.81 182.4 R(wner)-.25 E F3(O)2.94 E F0 2.94(,m)C(ode)383.31 182.4 Q F3(M)
2.94 E F0 2.94(,s)C(ize)418.35 182.4 Q F3(S)2.94 E F0 2.94(,m)C .44(odify time)
451.17 182.4 R F3(T)2.94 E F0(,)A(and name)72 194.4 Q F3(F)2.5 E F0
(are printed.)2.5 E(Possible responses to the REMO)72 210 Q(VE prompt are:)-.5
E 3.61(YES the)72 225.6 R(directory entry)2.5 E F3(F)2.5 E F0(is remo)2.5 E
-.15(ve)-.15 G(d.).15 E 8.06(NO ignore)72 241.2 R(this error condition.)2.5 E
F2(DUP/B)72 268.8 Q(AD I=)-.3 E F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2
(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3 2.5(Tt)C(ype)
324.15 268.8 Q F2(=)A F3(F)A F2(\(REMO)2.5 E(VE\))-.5 E F0 1.014
(Phase 1 or Phase 1b ha)72 280.8 R 1.314 -.15(ve f)-.2 H 1.014
(ound duplicate blocks or bad blocks associated with directory or \214le entry)
.15 F F3(F)3.514 E F0(,)A(inode)72 292.8 Q F3(I)2.5 E F0 5(.T)C(he o)113.66
292.8 Q(wner)-.25 E F3(O)2.5 E F0 2.5(,m)C(ode)172.84 292.8 Q F3(M)2.5 E F0 2.5
(,s)C(ize)207 292.8 Q F3(S)2.5 E F0 2.5(,m)C(odify time)238.94 292.8 Q F3(T)2.5
E F0 2.5(,a)C(nd directory name)297.83 292.8 Q F3(F)2.5 E F0(are printed.)2.5 E
(Possible responses to the REMO)72 308.4 Q(VE prompt are:)-.5 E 3.61(YES the)72
324 R(directory entry)2.5 E F3(F)2.5 E F0(is remo)2.5 E -.15(ve)-.15 G(d.).15 E
8.06(NO ignore)72 339.6 R(this error condition.)2.5 E F2(ZER)72 367.2 Q 2.5(OL)
-.3 G(ENGTH DIRECT)109.21 367.2 Q(OR)-.18 E 2.5(YI)-.35 G(=)214.8 367.2 Q F3(I)
A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A
F2(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(REMO)2.5 E(VE\))-.5 E F0 3.111
(Ad)72 379.2 S .611(irectory entry)87.331 379.2 R F3(F)3.111 E F0 .611
(has a size)3.111 F F3(S)3.111 E F0 .611(that is zero.)3.111 F .611(The o)5.611
F(wner)-.25 E F3(O)3.111 E F0 3.111(,m)C(ode)325.524 379.2 Q F3(M)3.111 E F0
3.111(,s)C(ize)360.906 379.2 Q F3(S)3.111 E F0 3.111(,m)C .611(odify time)
394.068 379.2 R F3(T)3.111 E F0 3.11(,a)C .61(nd directory)454.79 379.2 R(name)
72 391.2 Q F3(F)2.5 E F0(are printed.)2.5 E(Possible responses to the REMO)72
406.8 Q(VE prompt are:)-.5 E 3.61(YES the)72 422.4 R(directory entry)2.5 E F3
(F)2.5 E F0(is remo)2.5 E -.15(ve)-.15 G(d; this will al).15 E -.1(wa)-.1 G
(ys in).1 E -.2(vo)-.4 G .2 -.1(ke t).2 H(he B).1 E
(AD/DUP error condition in Phase 4.)-.35 E 8.06(NO ignore)72 438 R
(this error condition.)2.5 E F2(DIRECT)72 465.6 Q(OR)-.18 E 2.5(YT)-.35 G
(OO SHOR)141.57 465.6 Q 2.5(TI)-.4 G(=)200.63 465.6 Q F3(I)A F2 -.5(OW)2.5 G
(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E
F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(FIX\))2.5 E F0 2.593(Ad)72 477.6 S(irectory)
86.813 477.6 Q F3(F)2.593 E F0 .093(has been found whose size)2.593 F F3(S)
2.593 E F0 .093(is less than the minimum size directory)2.593 F 5.093(.T)-.65 G
.093(he o)416.678 477.6 R(wner)-.25 E F3(O)2.593 E F0 2.593(,m)C(ode)476.137
477.6 Q F3(M)2.593 E F0(,)A(size)72 489.6 Q F3(S)2.5 E F0 2.5(,m)C(odify time)
107.83 489.6 Q F3(T)2.5 E F0 2.5(,a)C(nd directory name)166.72 489.6 Q F3(F)2.5
E F0(are printed.)2.5 E(Possible responses to the FIX prompt are:)72 505.2 Q
3.61(YES increase)72 520.8 R
(the size of the directory to the minimum directory size.)2.5 E 8.06(NO ignore)
72 536.4 R(this directory)2.5 E(.)-.65 E F2(DIRECT)72 564 Q(OR)-.18 E(Y)-.35 E
F3(F)2.5 E F2(LENGTH)2.5 E F3(S)2.5 E F2(NO)2.5 E 2.5(TM)-.4 G(UL)229.69 564 Q
(TIPLE OF)-.92 E F3(B)2.5 E F2(\(ADJUST\))2.5 E F0 2.5(Ad)72 576 S(irectory)
86.72 576 Q F3(F)2.5 E F0(has been found with size)2.5 E F3(S)2.5 E F0
(that is not a multiple of the directory blocksize)2.5 E F3(B)2.5 E F0(.)A
(Possible responses to the ADJUST prompt are:)72 591.6 Q 3.61(YES the)72 607.2
R .431(length is rounded up to the appropriate block size.)2.932 F .431
(This error can occur on 4.2BSD \214le systems.)5.431 F
(Thus when preen'ing the \214le system only a w)97 619.2 Q
(arning is printed and the directory is adjusted.)-.1 E 8.06(NO ignore)72 634.8
R(the error condition.)2.5 E F2(DIRECT)72 662.4 Q(OR)-.18 E 2.5(YC)-.35 G(ORR)
142.3 662.4 Q(UPTED I=)-.3 E F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)
2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A
F2(\(SAL)2.5 E -.35 -1.35(VA G)-.92 H(E\))1.35 E F0 2.5(Ad)72 674.4 S
(irectory with an inconsistent internal state has been found.)86.72 674.4 Q
(Possible responses to the FIX prompt are:)72 690 Q 3.61(YES thro)72 705.6 R
3.415(wa)-.25 G -.1(wa)127.785 705.6 S 3.415(ya).1 G .915
(ll entries up to the ne)152.2 705.6 R .915
(xt directory boundary \(usually 512-byte\) boundary)-.15 F 5.915(.T)-.65 G
.915(his drastic)462.255 705.6 R 1.029(action can thro)97 717.6 R 3.529(wa)-.25
G -.1(wa)173.277 717.6 S 3.529(yu).1 G 3.529(pt)198.366 717.6 S 3.529(o4)
209.675 717.6 S 3.529(2e)223.204 717.6 S 1.029(ntries, and should be tak)
236.173 717.6 R 1.029(en only after other reco)-.1 F -.15(ve)-.15 G 1.028
(ry ef).15 F 1.028(forts ha)-.25 F -.15(ve)-.2 G -.1(fa)97 729.6 S(iled.).1 E
EP
%%Page: 16 16
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-16 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E 8.06(NO skip)72 84 R
(up to the ne)2.5 E(xt directory boundary and resume reading, b)-.15 E
(ut do not modify the directory)-.2 E(.)-.65 E/F2 10/Times-Bold@0 SF -.3(BA)72
111.6 S 2.5(DI).3 G(NODE NUMBER FOR `.)99.2 111.6 Q 2.5('I)-.55 G(=)216.14
111.6 Q/F3 10/Times-Italic@0 SF(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)
2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A
F2(\(FIX\))2.5 E F0 2.5(Ad)72 123.6 S(irectory)86.72 123.6 Q F3(I)2.5 E F0
(has been found whose inode number for `.)2.5 E 2.5('d)-.7 G
(oes does not equal)305.13 123.6 Q F3(I)2.5 E F0(.)A
(Possible responses to the FIX prompt are:)72 139.2 Q 3.61(YES change)72 154.8
R(the inode number for `.)2.5 E 2.5('t)-.7 G 2.5(ob)228.21 154.8 S 2.5(ee)
240.71 154.8 S(qual to)252.09 154.8 Q F3(I)2.5 E F0(.)A 8.06(NO lea)72 170.4 R
.3 -.15(ve t)-.2 H(he inode number for `.).15 E 2.5('u)-.7 G(nchanged.)222.86
170.4 Q F2(MISSING `.)72 198 Q 2.5('I)-.55 G(=)132.84 198 Q F3(I)A F2 -.5(OW)
2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)
2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(FIX\))2.5 E F0 2.5(Ad)72 210 S(irectory)
86.72 210 Q F3(I)2.5 E F0(has been found whose \214rst entry is unallocated.)
2.5 E(Possible responses to the FIX prompt are:)72 225.6 Q 3.61(YES b)72 241.2
R(uild an entry for `.)-.2 E 2.5('w)-.7 G(ith inode number equal to)187.19
241.2 Q F3(I)2.5 E F0(.)A 8.06(NO lea)72 256.8 R .3 -.15(ve t)-.2 H
(he directory unchanged.).15 E F2(MISSING `.)72 284.4 Q 2.5('I)-.55 G(=)132.84
284.4 Q F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)
2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(CANNO)72 296.4 Q
2.5(TF)-.4 G(IX, FIRST ENTR)123.54 296.4 Q 2.5(YI)-.35 G 2.5(ND)212.64 296.4 S
(IRECT)229.58 296.4 Q(OR)-.18 E 2.5(YC)-.35 G(ONT)292.66 296.4 Q(AINS)-.9 E F3
(F)2.5 E F0 3.745(Ad)72 308.4 S(irectory)87.965 308.4 Q F3(I)3.745 E F0 1.245
(has been found whose \214rst entry is)3.745 F F3(F)3.745 E F0(.)A F3(Fsc)6.245
E(k)-.2 E F0 1.245(cannot resolv)3.745 F 3.745(et)-.15 G 1.245(his problem.)
382.91 308.4 R 1.245(The \214le system)6.245 F .178
(should be mounted and the of)72 320.4 R .178(fending entry)-.25 F F3(F)2.678 E
F0(mo)2.678 E -.15(ve)-.15 G 2.678(de).15 G(lse)290.524 320.4 Q 2.678
(where. The)-.25 F .178(\214le system should then be unmounted)2.678 F(and)72
332.4 Q F3(fsc)2.5 E(k)-.2 E F0(should be run ag)2.5 E(ain.)-.05 E F2
(MISSING `.)72 360 Q 2.5('I)-.55 G(=)132.84 360 Q F3(I)A F2 -.5(OW)2.5 G(NER=)
.5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A
F2(DIR=)2.5 E F3(F)A F2(CANNO)72 372 Q 2.5(TF)-.4 G(IX, INSUFFICIENT SP)123.54
372 Q -.55(AC)-.74 G 2.5(ET).55 G 2.5(OA)254.3 372 S(DD `.)271.8 372 Q(')-.55 E
F0 2.551(Ad)72 384 S(irectory)86.771 384 Q F3(I)2.551 E F0 .051
(has been found whose \214rst entry is not `.)2.551 F('.)-.7 E F3(Fsc)5.051 E
(k)-.2 E F0 .051(cannot resolv)2.551 F 2.551(et)-.15 G .051
(his problem as it should ne)383.875 384 R -.15(ve)-.25 G(r).15 E 2.5
(happen. See)72 396 R 2.5(ag)2.5 G(uru.)137.26 396 Q F2(EXTRA `.)72 423.6 Q 2.5
('E)-.55 G(NTR)127.28 423.6 Q 2.5(YI)-.35 G(=)161.65 423.6 Q F3(I)A F2 -.5(OW)
2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)
2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(FIX\))2.5 E F0 2.5(Ad)72 435.6 S
(irectory)86.72 435.6 Q F3(I)2.5 E F0
(has been found that has more than one entry for `.)2.5 E('.)-.7 E
(Possible responses to the FIX prompt are:)72 451.2 Q 3.61(YES remo)72 466.8 R
.3 -.15(ve t)-.15 H(he e).15 E(xtra entry for `.)-.15 E('.)-.7 E 8.06(NO lea)72
482.4 R .3 -.15(ve t)-.2 H(he directory unchanged.).15 E F2 -.3(BA)72 510 S 2.5
(DI).3 G(NODE NUMBER FOR `..)99.2 510 Q 2.5('I)-.55 G(=)218.64 510 Q F3(I)A F2
-.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2
(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(FIX\))2.5 E F0 2.5(Ad)72 522 S
(irectory)86.72 522 Q F3(I)2.5 E F0(has been found whose inode number for `..)
2.5 E 2.5('d)-.7 G(oes does not equal the parent of)307.63 522 Q F3(I)2.5 E F0
(.)A(Possible responses to the FIX prompt are:)72 537.6 Q 3.61(YES change)72
553.2 R(the inode number for `..)2.5 E 2.5('t)-.7 G 2.5(ob)230.71 553.2 S 2.5
(ee)243.21 553.2 S(qual to the parent of)254.59 553.2 Q F3(I)2.5 E F0(\(`)2.5 E
(`)-.74 E F2(..)A F0 1.48 -.74('' i)D 2.5(nt).74 G
(he root inode points to itself\).)379.19 553.2 Q 8.06(NO lea)72 568.8 R .3
-.15(ve t)-.2 H(he inode number for `..).15 E 2.5('u)-.7 G(nchanged.)225.36
568.8 Q F2(MISSING `..)72 596.4 Q 2.5('I)-.55 G(=)135.34 596.4 Q F3(I)A F2 -.5
(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2
(MTIME=)2.5 E F3(T)A F2(DIR=)2.5 E F3(F)A F2(\(FIX\))2.5 E F0 2.5(Ad)72 608.4 S
(irectory)86.72 608.4 Q F3(I)2.5 E F0
(has been found whose second entry is unallocated.)2.5 E
(Possible responses to the FIX prompt are:)72 624 Q 3.61(YES b)72 639.6 R 1.222
(uild an entry for `..)-.2 F 3.722('w)-.7 G 1.222
(ith inode number equal to the parent of)195.8 639.6 R F3(I)3.722 E F0(\(`)
3.722 E(`)-.74 E F2(..)A F0 2.702 -.74('' i)D 3.722(nt).74 G 1.222
(he root inode points to)409.112 639.6 R(itself\).)97 651.6 Q 8.06(NO lea)72
667.2 R .3 -.15(ve t)-.2 H(he directory unchanged.).15 E F2(MISSING `..)72
694.8 Q 2.5('I)-.55 G(=)135.34 694.8 Q F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A
F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(DIR=)2.5
E F3(F)A F2(CANNO)72 706.8 Q 2.5(TF)-.4 G(IX, SECOND ENTR)123.54 706.8 Q 2.5
(YI)-.35 G 2.5(ND)224.86 706.8 S(IRECT)241.8 706.8 Q(OR)-.18 E 2.5(YC)-.35 G
(ONT)304.88 706.8 Q(AINS)-.9 E F3(F)2.5 E F0 3.066(Ad)72 718.8 S(irectory)
87.286 718.8 Q F3(I)3.066 E F0 .566(has been found whose second entry is)3.066
F F3(F)3.067 E F0(.)A F3(Fsc)5.567 E(k)-.2 E F0 .567(cannot resolv)3.067 F
3.067(et)-.15 G .567(his problem.)385.622 718.8 R .567(The \214le system)5.567
F .178(should be mounted and the of)72 730.8 R .178(fending entry)-.25 F F3(F)
2.678 E F0(mo)2.678 E -.15(ve)-.15 G 2.678(de).15 G(lse)290.524 730.8 Q 2.678
(where. The)-.25 F .178(\214le system should then be unmounted)2.678 F EP
%%Page: 17 17
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-17)459.55 48 Q(and)72 84 Q/F2 10
/Times-Italic@0 SF(fsc)2.5 E(k)-.2 E F0(should be run ag)2.5 E(ain.)-.05 E/F3
10/Times-Bold@0 SF(MISSING `..)72 111.6 Q 2.5('I)-.55 G(=)135.34 111.6 Q F2(I)A
F3 -.5(OW)2.5 G(NER=).5 E F2(O)A F3(MODE=)2.5 E F2(M)A F3(SIZE=)2.5 E F2(S)A F3
(MTIME=)2.5 E F2(T)A F3(DIR=)2.5 E F2(F)A F3(CANNO)72 123.6 Q 2.5(TF)-.4 G
(IX, INSUFFICIENT SP)123.54 123.6 Q -.55(AC)-.74 G 2.5(ET).55 G 2.5(OA)254.3
123.6 S(DD `..)271.8 123.6 Q(')-.55 E F0 2.591(Ad)72 135.6 S(irectory)86.811
135.6 Q F2(I)2.591 E F0 .091(has been found whose second entry is not `..)2.591
F('.)-.7 E F2(Fsc)5.092 E(k)-.2 E F0 .092(cannot resolv)2.592 F 2.592(et)-.15 G
.092(his problem.)399.192 135.6 R .092(The \214le sys-)5.092 F .039
(tem should be mounted and the second entry in the directory mo)72 147.6 R -.15
(ve)-.15 G 2.539(de).15 G(lse)351.018 147.6 Q 2.539(where. The)-.25 F .038
(\214le system should then)2.539 F(be unmounted and)72 159.6 Q F2(fsc)2.5 E(k)
-.2 E F0(should be run ag)2.5 E(ain.)-.05 E F3(EXTRA `..)72 187.2 Q 2.5('E)-.55
G(NTR)129.78 187.2 Q 2.5(YI)-.35 G(=)164.15 187.2 Q F2(I)A F3 -.5(OW)2.5 G
(NER=).5 E F2(O)A F3(MODE=)2.5 E F2(M)A F3(SIZE=)2.5 E F2(S)A F3(MTIME=)2.5 E
F2(T)A F3(DIR=)2.5 E F2(F)A F3(\(FIX\))2.5 E F0 2.5(Ad)72 199.2 S(irectory)
86.72 199.2 Q F2(I)2.5 E F0
(has been found that has more than one entry for `..)2.5 E('.)-.7 E
(Possible responses to the FIX prompt are:)72 214.8 Q 3.61(YES remo)72 230.4 R
.3 -.15(ve t)-.15 H(he e).15 E(xtra entry for `..)-.15 E('.)-.7 E 8.06(NO lea)
72 246 R .3 -.15(ve t)-.2 H(he directory unchanged.).15 E F2(N)72 273.6 Q F3
(IS AN EXTRANEOUS HARD LINK T)2.5 E 2.5(OAD)-.18 G(IRECT)275.72 273.6 Q(OR)-.18
E(Y)-.35 E F2(D)2.5 E F3(\(REMO)2.5 E(VE\))-.5 E F2(Fsc)72 285.6 Q(k)-.2 E F0
(has found a hard link,)2.5 E F2(N)2.5 E F0 2.5(,t)C 2.5(oad)197.06 285.6 S
(irectory)216.5 285.6 Q(,)-.65 E F2(D)2.5 E F0 5(.W)C(hen preen'ing the e)
276.11 285.6 Q(xtraneous links are ignored.)-.15 E
(Possible responses to the REMO)72 301.2 Q(VE prompt are:)-.5 E 3.61
(YES delete)72 316.8 R(the e)2.5 E(xtraneous entry)-.15 E(,)-.65 E F2(N)2.5 E
F0(.)A 8.06(NO ignore)72 332.4 R(the error condition.)2.5 E F3 -.3(BA)72 360 S
2.5(DI).3 G(NODE)99.2 360 Q F2(S)2.5 E F3 .36 -.18(TO D)2.5 H(ESCEND).18 E F0
.503(An internal error has caused an impossible state)72 372 R F2(S)3.003 E F0
.503(to be passed to the routine that descends the \214le system)3.003 F
(directory structure.)72 384 Q F2(Fsc)5 E(k)-.2 E F0 -.15(ex)2.5 G 2.5
(its. See).15 F 2.5(ag)2.5 G(uru.)229.39 384 Q F3 -.3(BA)72 411.6 S 2.5(DR).3 G
(ETURN ST)102.53 411.6 Q -.95(AT)-.9 G(E).95 E F2(S)2.5 E F3(FR)2.5 E
(OM DESCEND)-.3 E F0 .153(An internal error has caused an impossible state)72
423.6 R F2(S)2.653 E F0 .153
(to be returned from the routine that descends the \214le sys-)2.653 F
(tem directory structure.)72 435.6 Q F2(Fsc)5 E(k)-.2 E F0 -.15(ex)2.5 G 2.5
(its. See).15 F 2.5(ag)2.5 G(uru.)246.89 435.6 Q F3 -.3(BA)72 463.2 S 2.5(DS).3
G -.9(TA)100.87 463.2 S(TE)-.05 E F2(S)2.5 E F3(FOR R)2.5 E(OO)-.3 E 2.5(TI)-.4
G(NODE)195 463.2 Q F0(An internal error has caused an impossible state)72 475.2
Q F2(S)2.5 E F0(to be assigned to the root inode.)2.5 E F2(Fsc)5 E(k)-.2 E F0
-.15(ex)2.5 G 2.5(its. See).15 F 2.5(ag)2.5 G(uru.)482.14 475.2 Q F3 2.5
(4.6. Phase)72 499.2 R 2.5(3\255C)2.5 G(heck Connecti)142.42 499.2 Q(vity)-.1 E
F0 1.172(This phase concerns itself with the directory connecti)97 514.8 R
1.172(vity seen in Phase 2.)-.25 F 1.172(This section lists error)6.172 F
(conditions resulting from unreferenced directories, and missing or full)72
526.8 Q F2(lost+found)2.5 E F0(directories.)2.5 E F3(UNREF DIR I=)72 554.4 Q F2
(I)A F3 -.5(OW)2.5 G(NER=).5 E F2(O)A F3(MODE=)2.5 E F2(M)A F3(SIZE=)2.5 E F2
(S)A F3(MTIME=)2.5 E F2(T)A F3(\(RECONNECT\))2.5 E F0 .038(The directory inode)
72 566.4 R F2(I)2.538 E F0 -.1(wa)2.538 G 2.538(sn).1 G .038
(ot connected to a directory entry when the \214le system w)182.34 566.4 R .037
(as tra)-.1 F -.15(ve)-.2 G 2.537(rsed. The).15 F -.25(ow)2.537 G(ner).25 E F2
(O)72 578.4 Q F0 3.384(,m)C(ode)92.884 578.4 Q F2(M)3.384 E F0 3.384(,s)C(ize)
128.812 578.4 Q F2(S)3.384 E F0 3.384(,a)C .884(nd modify time)159.18 578.4 R
F2(T)3.384 E F0 .884(of directory inode)3.384 F F2(I)3.384 E F0 .884
(are printed.)3.384 F .885(When preen'ing, the directory is)5.884 F
(reconnected if its size is non-zero, otherwise it is cleared.)72 590.4 Q
(Possible responses to the RECONNECT prompt are:)72 606 Q 3.61(YES reconnect)72
621.6 R .296(directory inode)2.796 F F2(I)2.796 E F0 .296
(to the \214le system in the directory for lost \214les \(usually)2.796 F F2
(lost+found)2.795 E F0 2.795(\). This)B 1.659(may in)97 633.6 R -.2(vo)-.4 G
1.859 -.1(ke t).2 H(he).1 E F2(lost+found)4.159 E F0 1.659
(error condition in Phase 3 if there are problems connecting directory)4.159 F
(inode)97 645.6 Q F2(I)2.77 E F0(to)2.77 E F2(lost+found)2.77 E F0 5.27(.T)C
.27(his may also in)196.5 645.6 R -.2(vo)-.4 G .469 -.1(ke t).2 H .269
(he CONNECTED error condition in Phase 3 if the link).1 F -.1(wa)97 657.6 S 2.5
(ss).1 G(uccessful.)118.84 657.6 Q 8.06(NO ignore)72 673.2 R
(this error condition.)2.5 E(This will al)5 E -.1(wa)-.1 G(ys in).1 E -.2(vo)
-.4 G .2 -.1(ke t).2 H(he UNREF error condition in Phase 4.).1 E F3(NO lost+f)
72 700.8 Q(ound DIRECT)-.25 E(OR)-.18 E 2.5(Y\()-.35 G(CREA)203.87 700.8 Q
(TE\))-.95 E F0 .245(There is no)72 712.8 R F2(lost+found)2.745 E F0 .245
(directory in the root directory of the \214le system; When preen'ing)2.745 F
F2(fsc)2.745 E(k)-.2 E F0 .245(tries to create)2.745 F(a)72 724.8 Q F2
(lost+found)2.5 E F0(directory)2.5 E(.)-.65 E EP
%%Page: 18 18
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-18 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E(Possible responses to the CREA)
72 84 Q(TE prompt are:)-1.11 E 3.61(YES create)72 99.6 R(a)2.5 E/F2 10
/Times-Italic@0 SF(lost+found)2.5 E F0
(directory in the root of the \214le system.)2.5 E(This may raise the message:)
5 E/F3 10/Times-Bold@0 SF(NO SP)97 111.6 Q -.55(AC)-.74 G 2.5(EL).55 G
(EFT IN / \(EXP)155.16 111.6 Q(AND\))-.74 E F0 .954(See belo)97 123.6 R 3.454
(wf)-.25 G .954(or the possible responses.)145.868 123.6 R .954
(Inability to create a)5.954 F F2(lost+found)3.453 E F0 .953
(directory generates the mes-)3.453 F(sage:)97 135.6 Q F3(SORR)97 147.6 Q 1.84
-.92(Y. C)-.35 H(ANNO).92 E 2.5(TC)-.4 G(REA)188.38 147.6 Q(TE lost+f)-.95 E
(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E F0 .564
(and aborts the attempt to linkup the lost inode.)97 159.6 R .564(This will al)
5.564 F -.1(wa)-.1 G .565(ys in).1 F -.2(vo)-.4 G .765 -.1(ke t).2 H .565
(he UNREF error condition).1 F(in Phase 4.)97 171.6 Q 8.06(NO abort)72 187.2 R
1.224(the attempt to linkup the lost inode.)3.724 F 1.224(This will al)6.224 F
-.1(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.223
(he UNREF error condition in).1 F(Phase 4.)97 199.2 Q F3(lost+f)72 226.8 Q
(ound IS NO)-.25 E 2.5(TAD)-.4 G(IRECT)172.62 226.8 Q(OR)-.18 E 2.5(Y\()-.35 G
(REALLOCA)231.81 226.8 Q(TE\))-.95 E F0(The entry for)72 238.8 Q F2(lost+found)
2.5 E F0(is not a directory)2.5 E(.)-.65 E(Possible responses to the REALLOCA)
72 254.4 Q(TE prompt are:)-1.11 E 3.61(YES allocate)72 270 R 3.515(ad)3.515 G
1.015(irectory inode, and change)144.57 270 R F2(lost+found)3.516 E F0 1.016
(to reference it.)3.516 F 1.016(The pre)6.016 F 1.016(vious inode reference by)
-.25 F(the)97 282 Q F2(lost+found)2.98 E F0 .48(name is not cleared.)2.98 F .48
(Thus it will either be reclaimed as an UNREF'ed inode or ha)5.48 F -.15(ve)-.2
G .26(its link count ADJUST'ed later in this Phase.)97 294 R .261
(Inability to create a)5.261 F F2(lost+found)2.761 E F0 .261
(directory generates the)2.761 F(message:)97 306 Q F3(SORR)97 318 Q 1.84 -.92
(Y. C)-.35 H(ANNO).92 E 2.5(TC)-.4 G(REA)188.38 318 Q(TE lost+f)-.95 E
(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E F0 .565
(and aborts the attempt to linkup the lost inode.)97 330 R .564(This will al)
5.564 F -.1(wa)-.1 G .564(ys in).1 F -.2(vo)-.4 G .764 -.1(ke t).2 H .564
(he UNREF error condition).1 F(in Phase 4.)97 342 Q 8.06(NO abort)72 357.6 R
1.223(the attempt to linkup the lost inode.)3.723 F 1.224(This will al)6.224 F
-.1(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.224
(he UNREF error condition in).1 F(Phase 4.)97 369.6 Q F3(NO SP)72 397.2 Q -.55
(AC)-.74 G 2.5(EL).55 G(EFT IN /lost+f)130.16 397.2 Q(ound \(EXP)-.25 E(AND\))
-.74 E F0 .718(There is no space to add another entry to the)72 409.2 R F2
(lost+found)3.218 E F0 .718
(directory in the root directory of the \214le system.)3.218 F
(When preen'ing the)72 421.2 Q F2(lost+found)2.5 E F0(directory is e)2.5 E
(xpanded.)-.15 E(Possible responses to the EXP)72 436.8 Q(AND prompt are:)-.92
E 3.61(YES the)72 452.4 R F2(lost+found)3.7 E F0 1.2(directory is e)3.7 F 1.2
(xpanded to mak)-.15 F 3.7(er)-.1 G 1.2(oom for the ne)292.71 452.4 R 3.7(we)
-.25 G(ntry)370.02 452.4 Q 6.2(.I)-.65 G 3.7(ft)397.51 452.4 S 1.2
(he attempted e)407.32 452.4 R(xpansion)-.15 E -.1(fa)97 464.4 S(ils).1 E F2
(fsc)2.5 E(k)-.2 E F0(prints the message:)2.5 E F3(SORR)97 476.4 Q 1.84 -.92
(Y. N)-.35 H 2.5(OS).92 G -1.57 -.74(PA C)158.79 476.4 T 2.5(EI).74 G 2.5(Nl)
191.11 476.4 S(ost+f)203.61 476.4 Q(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E F0
.565(and aborts the attempt to linkup the lost inode.)97 488.4 R .564
(This will al)5.564 F -.1(wa)-.1 G .564(ys in).1 F -.2(vo)-.4 G .764 -.1(ke t)
.2 H .564(he UNREF error condition).1 F .175(in Phase 4.)97 500.4 R .175
(Clean out unnecessary entries in)5.175 F F2(lost+found)2.675 E F0 5.176(.T)C
.176(his error is f)336.696 500.4 R .176(atal if the \214le system is being)-.1
F(preen'ed.)97 512.4 Q 8.06(NO abort)72 528 R 1.224
(the attempt to linkup the lost inode.)3.724 F 1.224(This will al)6.224 F -.1
(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.223
(he UNREF error condition in).1 F(Phase 4.)97 540 Q F3(DIR I=)72 567.6 Q F2(I1)
A F3(CONNECTED)2.5 E 2.5(.P)-.2 G(ARENT W)187.31 567.6 Q(AS I=)-1.2 E F2(I2)A
F0 .823(This is an advisory message indicating a directory inode)72 579.6 R F2
(I1)3.323 E F0 -.1(wa)3.323 G 3.324(ss).1 G .824(uccessfully connected to the)
341.194 579.6 R F2(lost+found)3.324 E F0(directory)72 591.6 Q 5.456(.T)-.65 G
.456(he parent inode)121.516 591.6 R F2(I2)2.956 E F0 .456
(of the directory inode)2.956 F F2(I1)2.956 E F0 .455
(is replaced by the inode number of the)2.956 F F2(lost+found)2.955 E F0
(directory)72 603.6 Q(.)-.65 E F3(DIRECT)72 631.2 Q(OR)-.18 E(Y)-.35 E F2(F)2.5
E F3(LENGTH)2.5 E F2(S)2.5 E F3(NO)2.5 E 2.5(TM)-.4 G(UL)229.69 631.2 Q
(TIPLE OF)-.92 E F2(B)2.5 E F3(\(ADJUST\))2.5 E F0 2.585(Ad)72 643.2 S
(irectory)86.805 643.2 Q F2(F)2.585 E F0 .085(has been found with size)2.585 F
F2(S)2.586 E F0 .086(that is not a multiple of the directory blocksize)2.586 F
F2(B)2.586 E F0 .086(\(this can reoccur)2.586 F
(in Phase 3 if it is not adjusted in Phase 2\).)72 655.2 Q
(Possible responses to the ADJUST prompt are:)72 670.8 Q 3.61(YES the)72 686.4
R .431(length is rounded up to the appropriate block size.)2.932 F .431
(This error can occur on 4.2BSD \214le systems.)5.431 F
(Thus when preen'ing the \214le system only a w)97 698.4 Q
(arning is printed and the directory is adjusted.)-.1 E 8.06(NO ignore)72 714 R
(the error condition.)2.5 E EP
%%Page: 19 19
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-19)459.55 48 Q/F2 10/Times-Bold@0 SF -.3
(BA)72 84 S 2.5(DI).3 G(NODE)99.2 84 Q/F3 10/Times-Italic@0 SF(S)2.5 E F2 .36
-.18(TO D)2.5 H(ESCEND).18 E F0 .503
(An internal error has caused an impossible state)72 96 R F3(S)3.003 E F0 .503
(to be passed to the routine that descends the \214le system)3.003 F
(directory structure.)72 108 Q F3(Fsc)5 E(k)-.2 E F0 -.15(ex)2.5 G 2.5
(its. See).15 F 2.5(ag)2.5 G(uru.)229.39 108 Q F2 2.5(4.7. Phase)72 132 R 2.5
(4\255C)2.5 G(heck Refer)142.42 132 Q(ence Counts)-.18 E F0 .332(This phase co\
ncerns itself with the link count information seen in Phase 2 and Phase 3.)97
147.6 R .332(This section)5.332 F .778
(lists error conditions resulting from unreferenced \214les, missing or full)72
159.6 R F3(lost+found)3.278 E F0(directory)3.278 E 3.278(,i)-.65 G .778
(ncorrect link)452.402 159.6 R .424(counts for \214les, directories, symbolic \
links, or special \214les, unreferenced \214les, symbolic links, and directo-)
72 171.6 R .758(ries, and bad or duplicate blocks in \214les, symbolic links, \
and directories.)72 183.6 R .759(All errors in this phase are cor)5.758 F(-)-.2
E(rectable if the \214le system is being preen'ed e)72 195.6 Q
(xcept running out of space in the)-.15 E F3(lost+found)2.5 E F0(directory)2.5
E(.)-.65 E F2(UNREF FILE I=)72 223.2 Q F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A
F2(MODE=)2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2
(\(RECONNECT\))2.5 E F0(Inode)72 235.2 Q F3(I)2.843 E F0 -.1(wa)2.843 G 2.843
(sn).1 G .343(ot connected to a directory entry when the \214le system w)
127.079 235.2 R .342(as tra)-.1 F -.15(ve)-.2 G 2.842(rsed. The).15 F -.25(ow)
2.842 G(ner).25 E F3(O)2.842 E F0 2.842(,m)C(ode)475.888 235.2 Q F3(M)2.842 E
F0(,)A(size)72 247.2 Q F3(S)3.111 E F0 3.111(,a)C .611(nd modify time)105.712
247.2 R F3(T)3.112 E F0 .612(of inode)3.112 F F3(I)3.112 E F0 .612
(are printed.)3.112 F .612
(When preen'ing the \214le is cleared if either its size or its)5.612 F
(link count is zero, otherwise it is reconnected.)72 259.2 Q
(Possible responses to the RECONNECT prompt are:)72 274.8 Q 3.61(YES reconnect)
72 290.4 R(inode)3.976 E F3(I)3.976 E F0 1.476
(to the \214le system in the directory for lost \214les \(usually)3.976 F F3
(lost+found)3.975 E F0 3.975(\). This)B(may)3.975 E(in)97 302.4 Q -.2(vo)-.4 G
2.914 -.1(ke t).2 H(he).1 E F3(lost+found)5.214 E F0 2.715
(error condition in Phase 4 if there are problems connecting inode)5.214 F F3
(I)5.215 E F0(to)5.215 E F3(lost+found)97 314.4 Q F0(.)A 8.06(NO ignore)72 330
R(this error condition.)2.5 E(This will al)5 E -.1(wa)-.1 G(ys in).1 E -.2(vo)
-.4 G .2 -.1(ke t).2 H(he CLEAR error condition in Phase 4.).1 E F2(\(CLEAR\))
72 357.6 Q F0 1.555(The inode mentioned in the immediately pre)72 369.6 R 1.554
(vious error condition can not be reconnected.)-.25 F 1.554(This cannot)6.554 F
(occur if the \214le system is being preen'ed, since lack of space to reconnec\
t \214les is a f)72 381.6 Q(atal error)-.1 E(.)-.55 E
(Possible responses to the CLEAR prompt are:)72 397.2 Q 3.61(YES de-allocate)72
412.8 R(the inode mentioned in the immediately pre)2.5 E
(vious error condition by zeroing its contents.)-.25 E 8.06(NO ignore)72 428.4
R(this error condition.)2.5 E F2(NO lost+f)72 456 Q(ound DIRECT)-.25 E(OR)-.18
E 2.5(Y\()-.35 G(CREA)203.87 456 Q(TE\))-.95 E F0 .245(There is no)72 468 R F3
(lost+found)2.745 E F0 .245
(directory in the root directory of the \214le system; When preen'ing)2.745 F
F3(fsc)2.745 E(k)-.2 E F0 .245(tries to create)2.745 F(a)72 480 Q F3
(lost+found)2.5 E F0(directory)2.5 E(.)-.65 E(Possible responses to the CREA)72
495.6 Q(TE prompt are:)-1.11 E 3.61(YES create)72 511.2 R(a)2.5 E F3
(lost+found)2.5 E F0(directory in the root of the \214le system.)2.5 E
(This may raise the message:)5 E F2(NO SP)97 523.2 Q -.55(AC)-.74 G 2.5(EL).55
G(EFT IN / \(EXP)155.16 523.2 Q(AND\))-.74 E F0 .954(See belo)97 535.2 R 3.454
(wf)-.25 G .954(or the possible responses.)145.868 535.2 R .954
(Inability to create a)5.954 F F3(lost+found)3.453 E F0 .953
(directory generates the mes-)3.453 F(sage:)97 547.2 Q F2(SORR)97 559.2 Q 1.84
-.92(Y. C)-.35 H(ANNO).92 E 2.5(TC)-.4 G(REA)188.38 559.2 Q(TE lost+f)-.95 E
(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E F0 .564
(and aborts the attempt to linkup the lost inode.)97 571.2 R .564(This will al)
5.564 F -.1(wa)-.1 G .565(ys in).1 F -.2(vo)-.4 G .765 -.1(ke t).2 H .565
(he UNREF error condition).1 F(in Phase 4.)97 583.2 Q 8.06(NO abort)72 598.8 R
1.224(the attempt to linkup the lost inode.)3.724 F 1.224(This will al)6.224 F
-.1(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.223
(he UNREF error condition in).1 F(Phase 4.)97 610.8 Q F2(lost+f)72 638.4 Q
(ound IS NO)-.25 E 2.5(TAD)-.4 G(IRECT)172.62 638.4 Q(OR)-.18 E 2.5(Y\()-.35 G
(REALLOCA)231.81 638.4 Q(TE\))-.95 E F0(The entry for)72 650.4 Q F3(lost+found)
2.5 E F0(is not a directory)2.5 E(.)-.65 E(Possible responses to the REALLOCA)
72 666 Q(TE prompt are:)-1.11 E 3.61(YES allocate)72 681.6 R 3.515(ad)3.515 G
1.015(irectory inode, and change)144.57 681.6 R F3(lost+found)3.516 E F0 1.016
(to reference it.)3.516 F 1.016(The pre)6.016 F 1.016(vious inode reference by)
-.25 F(the)97 693.6 Q F3(lost+found)2.98 E F0 .48(name is not cleared.)2.98 F
.48(Thus it will either be reclaimed as an UNREF'ed inode or ha)5.48 F -.15(ve)
-.2 G .26(its link count ADJUST'ed later in this Phase.)97 705.6 R .261
(Inability to create a)5.261 F F3(lost+found)2.761 E F0 .261
(directory generates the)2.761 F(message:)97 717.6 Q F2(SORR)97 729.6 Q 1.84
-.92(Y. C)-.35 H(ANNO).92 E 2.5(TC)-.4 G(REA)188.38 729.6 Q(TE lost+f)-.95 E
(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E EP
%%Page: 20 20
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 232.008(SMM:3-20 The)72 48 R/F1 8/Times-Roman@0 SF
(UNIX)2.5 E F0(File System Check Program)2.5 E .565
(and aborts the attempt to linkup the lost inode.)97 84 R .564(This will al)
5.564 F -.1(wa)-.1 G .564(ys in).1 F -.2(vo)-.4 G .764 -.1(ke t).2 H .564
(he UNREF error condition).1 F(in Phase 4.)97 96 Q 8.06(NO abort)72 111.6 R
1.223(the attempt to linkup the lost inode.)3.723 F 1.224(This will al)6.224 F
-.1(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.224
(he UNREF error condition in).1 F(Phase 4.)97 123.6 Q/F2 10/Times-Bold@0 SF
(NO SP)72 151.2 Q -.55(AC)-.74 G 2.5(EL).55 G(EFT IN /lost+f)130.16 151.2 Q
(ound \(EXP)-.25 E(AND\))-.74 E F0 .718
(There is no space to add another entry to the)72 163.2 R/F3 10/Times-Italic@0
SF(lost+found)3.218 E F0 .718
(directory in the root directory of the \214le system.)3.218 F
(When preen'ing the)72 175.2 Q F3(lost+found)2.5 E F0(directory is e)2.5 E
(xpanded.)-.15 E(Possible responses to the EXP)72 190.8 Q(AND prompt are:)-.92
E 3.61(YES the)72 206.4 R F3(lost+found)3.7 E F0 1.2(directory is e)3.7 F 1.2
(xpanded to mak)-.15 F 3.7(er)-.1 G 1.2(oom for the ne)292.71 206.4 R 3.7(we)
-.25 G(ntry)370.02 206.4 Q 6.2(.I)-.65 G 3.7(ft)397.51 206.4 S 1.2
(he attempted e)407.32 206.4 R(xpansion)-.15 E -.1(fa)97 218.4 S(ils).1 E F3
(fsc)2.5 E(k)-.2 E F0(prints the message:)2.5 E F2(SORR)97 230.4 Q 1.84 -.92
(Y. N)-.35 H 2.5(OS).92 G -1.57 -.74(PA C)158.79 230.4 T 2.5(EI).74 G 2.5(Nl)
191.11 230.4 S(ost+f)203.61 230.4 Q(ound DIRECT)-.25 E(OR)-.18 E(Y)-.35 E F0
.565(and aborts the attempt to linkup the lost inode.)97 242.4 R .564
(This will al)5.564 F -.1(wa)-.1 G .564(ys in).1 F -.2(vo)-.4 G .764 -.1(ke t)
.2 H .564(he UNREF error condition).1 F .175(in Phase 4.)97 254.4 R .175
(Clean out unnecessary entries in)5.175 F F3(lost+found)2.675 E F0 5.176(.T)C
.176(his error is f)336.696 254.4 R .176(atal if the \214le system is being)-.1
F(preen'ed.)97 266.4 Q 8.06(NO abort)72 282 R 1.224
(the attempt to linkup the lost inode.)3.724 F 1.224(This will al)6.224 F -.1
(wa)-.1 G 1.224(ys in).1 F -.2(vo)-.4 G 1.424 -.1(ke t).2 H 1.223
(he UNREF error condition in).1 F(Phase 4.)97 294 Q F2 2.444(LINK COUNT)72
321.6 R F3(type)4.944 E F2(I=)4.944 E F3(I)A F2 -.5(OW)4.944 G(NER=).5 E F3(O)A
F2(MODE=)4.944 E F3(M)A F2(SIZE=)4.945 E F3(S)A F2(MTIME=)4.945 E F3(T)A F2
(COUNT=)4.945 E F3(X)A F2 2.445(SHOULD BE)4.945 F F3(Y)4.945 E F2(\(ADJUST\))72
333.6 Q F0 1.063(The link count for inode)72 345.6 R F3(I)3.563 E F0 3.563(,i)C
(s)189.198 345.6 Q F3(X)3.563 E F0 -.2(bu)3.563 G 3.563(ts).2 G 1.063(hould be)
226.357 345.6 R F3(Y)3.563 E F0 6.063(.T)C 1.063(he o)285.936 345.6 R(wner)-.25
E F3(O)3.563 E F0 3.562(,m)C(ode)348.304 345.6 Q F3(M)3.562 E F0 3.562(,s)C
(ize)384.588 345.6 Q F3(S)3.562 E F0 3.562(,a)C 1.062(nd modify time)415.312
345.6 R F3(T)3.562 E F0(are)3.562 E 3.064(printed. When)72 357.6 R .564(preen'\
ing the link count is adjusted unless the number of references is increasing, \
a condi-)3.064 F .83(tion that should ne)72 369.6 R -.15(ve)-.25 G 3.33(ro).15
G .829(ccur unless precipitated by a hardw)169.36 369.6 R .829(are f)-.1 F
3.329(ailure. When)-.1 F .829(the number of references is)3.329 F
(increasing under preen mode,)72 381.6 Q F3(fsc)2.5 E(k)-.2 E F0 -.15(ex)2.5 G
(its with the message:).15 E F2(LINK COUNT INCREASING)72 393.6 Q F0
(Possible responses to the ADJUST prompt are:)72 409.2 Q 3.61(YES replace)72
424.8 R(the link count of \214le inode)2.5 E F3(I)2.5 E F0(with)2.5 E F3(Y)2.5
E F0(.)A 8.06(NO ignore)72 440.4 R(this error condition.)2.5 E F2(UNREF)72 468
Q F3(type)2.5 E F2(I=)2.5 E F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)
2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(\(CLEAR\))2.5 E F0
(Inode)72 480 Q F3(I)2.711 E F0 2.711(,w)C .211
(as not connected to a directory entry when the \214le system w)113.142 480 R
.211(as tra)-.1 F -.15(ve)-.2 G 2.711(rsed. The).15 F -.25(ow)2.711 G(ner).25 E
F3(O)2.711 E F0 2.711(,m)C(ode)476.018 480 Q F3(M)2.712 E F0(,)A(size)72 492 Q
F3(S)3.803 E F0 3.803(,a)C 1.303(nd modify time)107.096 492 R F3(T)3.803 E F0
1.303(of inode)3.803 F F3(I)3.803 E F0 1.303(are printed.)3.803 F 1.302
(When preen'ing, this is a \214le that w)6.302 F 1.302(as not connected)-.1 F
(because its size or link count w)72 504 Q(as zero, hence it is cleared.)-.1 E
(Possible responses to the CLEAR prompt are:)72 519.6 Q 3.61(YES de-allocate)72
535.2 R(inode)2.5 E F3(I)2.5 E F0(by zeroing its contents.)2.5 E 8.06
(NO ignore)72 550.8 R(this error condition.)2.5 E F2 -.3(BA)72 578.4 S(D/DUP).3
E F3(type)2.5 E F2(I=)2.5 E F3(I)A F2 -.5(OW)2.5 G(NER=).5 E F3(O)A F2(MODE=)
2.5 E F3(M)A F2(SIZE=)2.5 E F3(S)A F2(MTIME=)2.5 E F3(T)A F2(\(CLEAR\))2.5 E F0
1.336(Phase 1 or Phase 1b ha)72 590.4 R 1.636 -.15(ve f)-.2 H 1.337
(ound duplicate blocks or bad blocks associated with inode).15 F F3(I)3.837 E
F0 6.337(.T)C 1.337(he o)452.426 590.4 R(wner)-.25 E F3(O)3.837 E F0(,)A(mode)
72 602.4 Q F3(M)3.141 E F0 3.141(,s)C(ize)115.222 602.4 Q F3(S)3.141 E F0 3.141
(,a)C .641(nd modify time)145.104 602.4 R F3(T)3.141 E F0 .641(of inode)3.141 F
F3(I)3.141 E F0 .64(are printed.)3.14 F .64
(This error cannot arise when the \214le system is)5.64 F
(being preen'ed, as it w)72 614.4 Q(ould ha)-.1 E .3 -.15(ve c)-.2 H(aused a f)
.15 E(atal error earlier)-.1 E(.)-.55 E
(Possible responses to the CLEAR prompt are:)72 630 Q 3.61(YES de-allocate)72
645.6 R(inode)2.5 E F3(I)2.5 E F0(by zeroing its contents.)2.5 E 8.06
(NO ignore)72 661.2 R(this error condition.)2.5 E F2 2.5(4.8. Phase)72 685.2 R
2.5(5-C)2.5 G(heck Cyl gr)140.05 685.2 Q(oups)-.18 E F0 .941
(This phase concerns itself with the free-block and used-inode maps.)97 700.8 R
.942(This section lists error condi-)5.942 F .157(tions resulting from allocat\
ed blocks in the free-block maps, free blocks missing from free-block maps, an\
d)72 712.8 R 1.31(the total free-block count incorrect.)72 724.8 R 1.31
(It also lists error conditions resulting from free inodes in the used-)6.31 F
EP
%%Page: 21 21
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The)72 48 Q/F1 8/Times-Roman@0 SF(UNIX)2.5 E F0
(File System Check Program)2.5 E(SMM:3-21)459.55 48 Q(inode maps, allocated in\
odes missing from used-inode maps, and the total used-inode count incorrect.)72
84 Q/F2 10/Times-Bold@0 SF(CG)72 111.6 Q/F3 10/Times-Italic@0 SF(C)2.5 E F2 2.5
(:B)C(AD MA)108.37 111.6 Q(GIC NUMBER)-.55 E F0 .339(The magic number of c)72
123.6 R .339(ylinder group)-.15 F F3(C)2.839 E F0 .339(is wrong.)2.839 F .339
(This usually indicates that the c)5.339 F .338(ylinder group maps ha)-.15 F
-.15(ve)-.2 G .069(been destro)72 135.6 R 2.569(yed. When)-.1 F .069
(running manually the c)2.569 F .069(ylinder group is mark)-.15 F .07
(ed as needing to be reconstructed.)-.1 F(This)5.07 E(error is f)72 147.6 Q
(atal if the \214le system is being preen'ed.)-.1 E F2
(BLK\(S\) MISSING IN BIT MAPS \(SAL)72 175.2 Q -.35 -1.35(VA G)-.92 H(E\))1.35
E F0 2.5(Ac)72 187.2 S(ylinder group block map is missing some free blocks.)
86.01 187.2 Q(During preen'ing the maps are reconstructed.)5 E
(Possible responses to the SAL)72 202.8 Q -.2 -1.35(VA G)-1 H 2.5(Ep)1.35 G
(rompt are:)225.63 202.8 Q 3.61(YES reconstruct)72 218.4 R(the free block map.)
2.5 E 8.06(NO ignore)72 234 R(this error condition.)2.5 E F2(SUMMAR)72 261.6 Q
2.5(YI)-.35 G(NFORMA)131.36 261.6 Q(TION B)-.95 E(AD \(SAL)-.3 E -.35 -1.35
(VA G)-.92 H(E\))1.35 E F0 .295(The summary information w)72 273.6 R .294
(as found to be incorrect.)-.1 F .294
(When preen'ing, the summary information is recom-)5.294 F(puted.)72 285.6 Q
(Possible responses to the SAL)72 301.2 Q -.2 -1.35(VA G)-1 H 2.5(Ep)1.35 G
(rompt are:)225.63 301.2 Q 3.61(YES reconstruct)72 316.8 R
(the summary information.)2.5 E 8.06(NO ignore)72 332.4 R
(this error condition.)2.5 E F2(FREE BLK COUNT\(S\) WR)72 360 Q
(ONG IN SUPERBLOCK \(SAL)-.3 E -.35 -1.35(VA G)-.92 H(E\))1.35 E F0 1.408
(The superblock free block information w)72 372 R 1.408
(as found to be incorrect.)-.1 F 1.408(When preen'ing, the superblock free)
6.408 F(block information is recomputed.)72 384 Q
(Possible responses to the SAL)72 399.6 Q -.2 -1.35(VA G)-1 H 2.5(Ep)1.35 G
(rompt are:)225.63 399.6 Q 3.61(YES reconstruct)72 415.2 R
(the superblock free block information.)2.5 E 8.06(NO ignore)72 430.8 R
(this error condition.)2.5 E F2 2.5(4.9. Cleanup)72 454.8 R F0 .275
(Once a \214le system has been check)97 470.4 R .274(ed, a fe)-.1 F 2.774(wc)
-.25 G .274(leanup functions are performed.)279.062 470.4 R .274
(This section lists advi-)5.274 F
(sory messages about the \214le system and modify status of the \214le system.)
72 482.4 Q F3(V)72 510 Q F2(\214les,)2.5 E F3(W)2.5 E F2(used,)2.5 E F3(X)2.5 E
F2(fr)2.5 E(ee \()-.18 E F3(Y)A F2(frags,)2.5 E F3(Z)2.5 E F2(blocks\))2.5 E F0
1.349(This is an advisory message indicating that the \214le system check)72
522 R 1.35(ed contained)-.1 F F3(V)3.85 E F0 1.35(\214les using)3.85 F F3(W)
3.85 E F0(fragment)3.85 E .15(sized blocks lea)72 534 R(ving)-.2 E F3(X)2.65 E
F0 .15(fragment sized blocks free in the \214le system.)2.65 F .15
(The numbers in parenthesis breaks the)5.15 F(free count do)72 546 Q(wn into)
-.25 E F3(Y)2.5 E F0(free fragments and)2.5 E F3(Z)2.5 E F0
(free full sized blocks.)2.5 E F2(***** REBOO)72 573.6 Q 2.5(TU)-.4 G
(NIX *****)151.61 573.6 Q F0 .483(This is an advisory message indicating that \
the root \214le system has been modi\214ed by)72 585.6 R F3(fsc)2.983 E(k.)-.2
E F0 .484(If UNIX is not)5.483 F .659(rebooted immediately)72 597.6 R 3.159(,t)
-.65 G .659(he w)167.938 597.6 R .659(ork done by)-.1 F F3(fsc)3.158 E(k)-.2 E
F0 .658(may be undone by the in-core copies of tables UNIX k)3.158 F(eeps.)-.1
E .753(When preen'ing,)72 609.6 R F3(fsc)3.253 E(k)-.2 E F0 .753(will e)3.253 F
.753(xit with a code of 4.)-.15 F .753(The standard auto-reboot script distrib)
5.753 F .754(uted with 4.3BSD)-.2 F(interprets an e)72 621.6 Q
(xit code of 4 by issuing a reboot system call.)-.15 E F2(***** FILE SYSTEM W)
72 649.2 Q(AS MODIFIED *****)-1.2 E F0 .315
(This is an advisory message indicating that the current \214le system w)72
661.2 R .314(as modi\214ed by)-.1 F F3(fsc)2.814 E(k.)-.2 E F0 .314
(If this \214le system)5.314 F 1.142
(is mounted or is the current root \214le system,)72 673.2 R F3(fsc)3.642 E(k)
-.2 E F0 1.142(should be halted and UNIX rebooted.)3.642 F 1.143
(If UNIX is not)6.142 F(rebooted immediately)72 685.2 Q 2.5(,t)-.65 G(he w)
166.62 685.2 Q(ork done by)-.1 E F3(fsc)2.5 E(k)-.2 E F0
(may be undone by the in-core copies of tables UNIX k)2.5 E(eeps.)-.1 E EP
%%Trailer
end
%%EOF
